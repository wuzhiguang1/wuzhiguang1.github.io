{"title":"uniapp开发，微信小程序接入友盟统计","slug":"201","date":"2022-03-21T08:00:56.000Z","updated":"2022-07-29T04:22:04.783Z","comments":true,"path":"api/articles/201.json","excerpt":null,"covers":["https://qny.aqingya.cn/img/20220321160927.png","https://qny.aqingya.cn/img/20220321160941.png"],"content":"<p>与原生的小程序开发不同，<a href=\"https://so.csdn.net/so/search?q=uniapp&spm=1001.2101.3001.7020\">uniapp</a>创建的项目没有<code>package.json</code>文件。</p>\n<h2 id=\"uniappnpm的配置：\"><a href=\"#uniappnpm的配置：\" class=\"headerlink\" title=\"uniappnpm的配置：\"></a>uniapp<code>npm</code>的配置：</h2><h4 id=\"1-在项目的根目录打开命令控制台：\"><a href=\"#1-在项目的根目录打开命令控制台：\" class=\"headerlink\" title=\"1.在项目的根目录打开命令控制台：\"></a>1.在项目的根目录打开命令控制台：</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm init -y</span><br></pre></td></tr></table></figure>\n\n<p>这时候就会在更目录中有<code>package.json</code>（我们这里不用修改改文件）</p>\n<h4 id=\"2-下载友盟的包\"><a href=\"#2-下载友盟的包\" class=\"headerlink\" title=\"2.下载友盟的包\"></a>2.下载友盟的包</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install umtrack-wx  --save</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"3-配置\"><a href=\"#3-配置\" class=\"headerlink\" title=\"3.配置\"></a>3.配置</h4><p>由于使用的是uniapp 所以不能按照官方给出的方式来配置：</p>\n<p>我们在<code>main.js</code>文件中加入一下内容：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> uma <span class=\"keyword\">from</span> <span class=\"string\">&#x27;umtrack-wx&#x27;</span>;</span><br><span class=\"line\">uma.init(&#123;</span><br><span class=\"line\">\t<span class=\"attr\">appKey</span>: <span class=\"string\">&#x27;你在友盟创建的程序key&#x27;</span>, <span class=\"comment\">//由友盟分配的APP_KEY</span></span><br><span class=\"line\">\t<span class=\"comment\">// 使用Openid进行统计，此项为false时将使用友盟+uuid进行用户统计。</span></span><br><span class=\"line\">\t<span class=\"comment\">// 使用Openid来统计微信小程序的用户，会使统计的指标更为准确，对系统准确性要求高的应用推荐使用Openid。</span></span><br><span class=\"line\">\t<span class=\"attr\">useOpenid</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">\t<span class=\"comment\">// 使用openid进行统计时，是否授权友盟自动获取Openid，</span></span><br><span class=\"line\">\t<span class=\"comment\">// 如若需要，请到友盟后台&quot;设置管理-应用信息&quot;(https://mp.umeng.com/setting/appset)中设置appId及secret</span></span><br><span class=\"line\">\t<span class=\"attr\">autoGetOpenid</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">\t<span class=\"attr\">debug</span>: <span class=\"literal\">true</span>, <span class=\"comment\">//是否打开调试模式</span></span><br><span class=\"line\">\t<span class=\"attr\">uploadUserInfo</span>: <span class=\"literal\">false</span> <span class=\"comment\">// 自动上传用户信息，设为false取消上传，默认为false</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 此处用来挂载入uma到组件实例上，方便组件内使用this.$uma</span></span><br><span class=\"line\">uma.install = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">Vue</span>) </span>&#123;</span><br><span class=\"line\">\tVue.prototype.$uma = uma;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Vue.use(uma);</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"4-使用\"><a href=\"#4-使用\" class=\"headerlink\" title=\"4.使用\"></a>4.使用</h4><p>使用的话 请根据项目需求来进行操作就可以了，我这边只需要给程序中的事件进行统计；所以就直接进入友盟的后台管理，添加<code>自定义事件</code>然后再小程序中对应的事件中加入以下代码就可以，监听点击了多少次。</p>\n<p><img src=\"https://qny.aqingya.cn/img/20220321160927.png\"></p>\n<p><img src=\"https://qny.aqingya.cn/img/20220321160941.png\"></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"title\">onClick</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">this</span>.$uma.trackEvent(<span class=\"string\">&#x27;eventID&#x27;</span>);<span class=\"comment\">//eventID是在友盟后台你自己创建的</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"原生的配置请参考：小程序npm配置\"><a href=\"#原生的配置请参考：小程序npm配置\" class=\"headerlink\" title=\"原生的配置请参考：小程序npm配置\"></a>原生的配置请参考：<a href=\"https://developers.weixin.qq.com/miniprogram/dev/devtools/npm.html\">小程序npm配置</a></h2><p>其他的配置，例如服务器配置与官网提供的一样；按照步骤来就可以了；</p>\n<p><a href=\"https://developer.umeng.com/docs/147615/detail/147619\">友盟小程序文档</a></p>\n<p>转载： <code>https://blog.csdn.net/weixin_41535944/article/details/111560040</code></p>\n","more":"<p>与原生的小程序开发不同，<a href=\"https://so.csdn.net/so/search?q=uniapp&spm=1001.2101.3001.7020\">uniapp</a>创建的项目没有<code>package.json</code>文件。</p>\n<h2 id=\"uniappnpm的配置：\"><a href=\"#uniappnpm的配置：\" class=\"headerlink\" title=\"uniappnpm的配置：\"></a>uniapp<code>npm</code>的配置：</h2><h4 id=\"1-在项目的根目录打开命令控制台：\"><a href=\"#1-在项目的根目录打开命令控制台：\" class=\"headerlink\" title=\"1.在项目的根目录打开命令控制台：\"></a>1.在项目的根目录打开命令控制台：</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm init -y</span><br></pre></td></tr></table></figure>\n\n<p>这时候就会在更目录中有<code>package.json</code>（我们这里不用修改改文件）</p>\n<h4 id=\"2-下载友盟的包\"><a href=\"#2-下载友盟的包\" class=\"headerlink\" title=\"2.下载友盟的包\"></a>2.下载友盟的包</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install umtrack-wx  --save</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"3-配置\"><a href=\"#3-配置\" class=\"headerlink\" title=\"3.配置\"></a>3.配置</h4><p>由于使用的是uniapp 所以不能按照官方给出的方式来配置：</p>\n<p>我们在<code>main.js</code>文件中加入一下内容：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> uma <span class=\"keyword\">from</span> <span class=\"string\">&#x27;umtrack-wx&#x27;</span>;</span><br><span class=\"line\">uma.init(&#123;</span><br><span class=\"line\">\t<span class=\"attr\">appKey</span>: <span class=\"string\">&#x27;你在友盟创建的程序key&#x27;</span>, <span class=\"comment\">//由友盟分配的APP_KEY</span></span><br><span class=\"line\">\t<span class=\"comment\">// 使用Openid进行统计，此项为false时将使用友盟+uuid进行用户统计。</span></span><br><span class=\"line\">\t<span class=\"comment\">// 使用Openid来统计微信小程序的用户，会使统计的指标更为准确，对系统准确性要求高的应用推荐使用Openid。</span></span><br><span class=\"line\">\t<span class=\"attr\">useOpenid</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">\t<span class=\"comment\">// 使用openid进行统计时，是否授权友盟自动获取Openid，</span></span><br><span class=\"line\">\t<span class=\"comment\">// 如若需要，请到友盟后台&quot;设置管理-应用信息&quot;(https://mp.umeng.com/setting/appset)中设置appId及secret</span></span><br><span class=\"line\">\t<span class=\"attr\">autoGetOpenid</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">\t<span class=\"attr\">debug</span>: <span class=\"literal\">true</span>, <span class=\"comment\">//是否打开调试模式</span></span><br><span class=\"line\">\t<span class=\"attr\">uploadUserInfo</span>: <span class=\"literal\">false</span> <span class=\"comment\">// 自动上传用户信息，设为false取消上传，默认为false</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 此处用来挂载入uma到组件实例上，方便组件内使用this.$uma</span></span><br><span class=\"line\">uma.install = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">Vue</span>) </span>&#123;</span><br><span class=\"line\">\tVue.prototype.$uma = uma;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Vue.use(uma);</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"4-使用\"><a href=\"#4-使用\" class=\"headerlink\" title=\"4.使用\"></a>4.使用</h4><p>使用的话 请根据项目需求来进行操作就可以了，我这边只需要给程序中的事件进行统计；所以就直接进入友盟的后台管理，添加<code>自定义事件</code>然后再小程序中对应的事件中加入以下代码就可以，监听点击了多少次。</p>\n<p><img src=\"https://qny.aqingya.cn/img/20220321160927.png\"></p>\n<p><img src=\"https://qny.aqingya.cn/img/20220321160941.png\"></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"title\">onClick</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">this</span>.$uma.trackEvent(<span class=\"string\">&#x27;eventID&#x27;</span>);<span class=\"comment\">//eventID是在友盟后台你自己创建的</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"原生的配置请参考：小程序npm配置\"><a href=\"#原生的配置请参考：小程序npm配置\" class=\"headerlink\" title=\"原生的配置请参考：小程序npm配置\"></a>原生的配置请参考：<a href=\"https://developers.weixin.qq.com/miniprogram/dev/devtools/npm.html\">小程序npm配置</a></h2><p>其他的配置，例如服务器配置与官网提供的一样；按照步骤来就可以了；</p>\n<p><a href=\"https://developer.umeng.com/docs/147615/detail/147619\">友盟小程序文档</a></p>\n<p>转载： <code>https://blog.csdn.net/weixin_41535944/article/details/111560040</code></p>\n","categories":[{"name":"uni-app开发","path":"api/categories/uni-app开发.json"}],"tags":[{"name":"微信小程序","path":"api/tags/微信小程序.json"},{"name":"uni-app开发","path":"api/tags/uni-app开发.json"}]}