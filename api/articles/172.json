{"title":"Vue3简单了解","slug":"172","date":"2021-11-22T13:40:38.000Z","updated":"2022-07-29T04:22:04.785Z","comments":true,"path":"api/articles/172.json","excerpt":null,"covers":["https://user-images.githubusercontent.com/499550/93624428-53932780-f9ae-11ea-8d16-af949e16a09f.png","https://cn.vitejs.dev/assets/bundler.37740380.png","https://cn.vuejs.org/images/lifecycle.png","https://v3.cn.vuejs.org/images/lifecycle.svg","https://qny.aqingya.cn/img/20220118180338.png","https://qny.aqingya.cn/img/20220118180458.png","https://v3.cn.vuejs.org/images/components_provide.png","https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f84e4e2c02424d9a99862ade0a2e4114~tplv-k3u1fbpfcp-watermark.image","https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e5ac7e20d1784887a826f6360768a368~tplv-k3u1fbpfcp-watermark.image","https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6cc55165c0e34069a75fe36f8712eb80~tplv-k3u1fbpfcp-watermark.image","https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bc0be8211fc54b6c941c036791ba4efe~tplv-k3u1fbpfcp-watermark.image"],"content":"<p><img src=\"https://user-images.githubusercontent.com/499550/93624428-53932780-f9ae-11ea-8d16-af949e16a09f.png\" style=\"width:200px\" /></p>\n<h2 id=\"1-Vue3简介\"><a href=\"#1-Vue3简介\" class=\"headerlink\" title=\"1.Vue3简介\"></a>1.Vue3简介</h2><ul>\n<li>2020年9月18日，Vue.js发布3.0版本，代号：One Piece（海贼王）</li>\n<li>耗时2年多、<a href=\"https://github.com/vuejs/vue-next/graphs/commit-activity\">2600+次提交</a>、<a href=\"https://github.com/vuejs/rfcs/tree/master/active-rfcs\">30+个RFC</a>、<a href=\"https://github.com/vuejs/vue-next/pulls?q=is%3Apr+is%3Amerged+-author%3Aapp%2Fdependabot-preview+\">600+次PR</a>、<a href=\"https://github.com/vuejs/vue-next/graphs/contributors\">99位贡献者</a> </li>\n<li>github上的tags地址：<a href=\"https://github.com/vuejs/vue-next/releases/tag/v3.0.0\">https://github.com/vuejs/vue-next/releases/tag/v3.0.0</a></li>\n</ul>\n<h2 id=\"2-Vue3带来了什么\"><a href=\"#2-Vue3带来了什么\" class=\"headerlink\" title=\"2.Vue3带来了什么\"></a>2.Vue3带来了什么</h2><h3 id=\"1-性能的提升\"><a href=\"#1-性能的提升\" class=\"headerlink\" title=\"1.性能的提升\"></a>1.性能的提升</h3><ul>\n<li><p>打包大小减少41%</p>\n</li>\n<li><p>初次渲染快55%, 更新渲染快133%</p>\n</li>\n<li><p>内存减少54%</p>\n<p>……</p>\n</li>\n</ul>\n<h3 id=\"2-源码的升级\"><a href=\"#2-源码的升级\" class=\"headerlink\" title=\"2.源码的升级\"></a>2.源码的升级</h3><ul>\n<li><p>使用Proxy代替defineProperty实现响应式</p>\n</li>\n<li><p>重写虚拟DOM的实现和Tree-Shaking</p>\n<p>……</p>\n</li>\n</ul>\n<h3 id=\"3-拥抱TypeScript\"><a href=\"#3-拥抱TypeScript\" class=\"headerlink\" title=\"3.拥抱TypeScript\"></a>3.拥抱TypeScript</h3><ul>\n<li>Vue3可以更好的支持TypeScript</li>\n</ul>\n<h3 id=\"4-新的特性\"><a href=\"#4-新的特性\" class=\"headerlink\" title=\"4.新的特性\"></a>4.新的特性</h3><ol>\n<li><p>Composition API（组合API）</p>\n<ul>\n<li>setup配置</li>\n<li>ref与reactive</li>\n<li>watch与watchEffect</li>\n<li>provide与inject</li>\n<li>……</li>\n</ul>\n</li>\n<li>新的内置组件<ul>\n<li>Fragment </li>\n<li>Teleport</li>\n<li>Suspense</li>\n</ul>\n</li>\n<li><p>其他改变</p>\n<ul>\n<li>新的生命周期钩子</li>\n<li>data 选项应始终被声明为一个函数</li>\n<li>移除keyCode支持作为 v-on 的修饰符</li>\n<li>……</li>\n</ul>\n</li>\n</ol>\n<h1 id=\"一、创建Vue3-0工程\"><a href=\"#一、创建Vue3-0工程\" class=\"headerlink\" title=\"一、创建Vue3.0工程\"></a>一、创建Vue3.0工程</h1><h2 id=\"1-使用-vue-cli-创建\"><a href=\"#1-使用-vue-cli-创建\" class=\"headerlink\" title=\"1.使用 vue-cli 创建\"></a>1.使用 vue-cli 创建</h2><p>官方文档：<a href=\"https://cli.vuejs.org/zh/guide/creating-a-project.html#vue-create\">https://cli.vuejs.org/zh/guide/creating-a-project.html#vue-create</a></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">## 查看@vue/cli版本，确保@vue/cli版本在4.5.0以上</span></span><br><span class=\"line\">vue --version</span><br><span class=\"line\"><span class=\"comment\">## 安装或者升级你的@vue/cli</span></span><br><span class=\"line\">npm install -g @vue/cli</span><br><span class=\"line\"><span class=\"comment\">## 创建</span></span><br><span class=\"line\">vue create vue_test</span><br><span class=\"line\"><span class=\"comment\">## 启动</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> vue_test</span><br><span class=\"line\">npm run serve</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-使用-vite-创建\"><a href=\"#2-使用-vite-创建\" class=\"headerlink\" title=\"2.使用 vite 创建\"></a>2.使用 vite 创建</h2><p>官方文档：<a href=\"https://v3.cn.vuejs.org/guide/installation.html#vite\">https://v3.cn.vuejs.org/guide/installation.html#vite</a></p>\n<p>vite官网：<a href=\"https://vitejs.cn\">https://vitejs.cn</a></p>\n<ul>\n<li>什么是vite？—— 新一代前端构建工具。</li>\n<li>优势如下：<ul>\n<li>开发环境中，无需打包操作，可快速的冷启动。</li>\n<li>轻量快速的热重载（HMR）。</li>\n<li>真正的按需编译，不再等待整个应用编译完成。</li>\n</ul>\n</li>\n<li>传统构建 与 vite构建对比图</li>\n</ul>\n<p><img src=\"https://cn.vitejs.dev/assets/bundler.37740380.png\" style=\"width:500px;height:280px;float:left\" /><img src=\"https://cn.vitejs.dev/assets/esm.3070012d.png\" style=\"width:480px;height:280px\" /></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">## 创建工程</span></span><br><span class=\"line\">npm init vite-app &lt;project-name&gt;</span><br><span class=\"line\"><span class=\"comment\">## 进入工程目录</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> &lt;project-name&gt;</span><br><span class=\"line\"><span class=\"comment\">## 安装依赖</span></span><br><span class=\"line\">npm install</span><br><span class=\"line\"><span class=\"comment\">## 运行</span></span><br><span class=\"line\">npm run dev</span><br></pre></td></tr></table></figure>\n<h1 id=\"二、常用-Composition-API\"><a href=\"#二、常用-Composition-API\" class=\"headerlink\" title=\"二、常用 Composition API\"></a>二、常用 Composition API</h1><p>官方文档: <a href=\"https://v3.cn.vuejs.org/guide/composition-api-introduction.html\">https://v3.cn.vuejs.org/guide/composition-api-introduction.html</a></p>\n<h2 id=\"1-拉开序幕的setup\"><a href=\"#1-拉开序幕的setup\" class=\"headerlink\" title=\"1.拉开序幕的setup\"></a>1.拉开序幕的setup</h2><ol>\n<li><p>理解：Vue3.0中一个新的配置项，值为一个函数。</p>\n</li>\n<li><p>setup是所有<strong style=\"color:#DD5145\">Composition API（组合API）</strong><i style=\"color:gray;font-weight:bold\">“ 表演的舞台 ”</i>。</p>\n</li>\n<li><p>组件中所用到的：数据、方法等等，均要配置在setup中。</p>\n</li>\n<li><p>setup函数的两种返回值：</p>\n<ol>\n<li>若返回一个对象，则对象中的属性、方法, 在模板中均可以直接使用。（重点关注！）</li>\n<li><span style=\"color:#aad\">若返回一个渲染函数：则可以自定义渲染内容。（了解）</span></li>\n</ol>\n</li>\n<li><p>注意点：</p>\n<ol>\n<li>尽量不要与Vue2.x配置混用<ul>\n<li>Vue2.x配置（data、methos、computed…）中<strong style=\"color:#DD5145\">可以访问到</strong>setup中的属性、方法。</li>\n<li>但在setup中<strong style=\"color:#DD5145\">不能访问到</strong>Vue2.x配置（data、methos、computed…）。</li>\n<li>如果有重名, setup优先。</li>\n</ul>\n</li>\n<li>setup不能是一个async函数，因为返回值不再是return的对象, 而是promise, 模板看不到return对象中的属性。（后期也可以返回一个Promise实例，但需要Suspense和异步组件的配合）</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>一个人的信息<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>姓名：&#123;&#123;name&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>年龄：&#123;&#123;age&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>性别：&#123;&#123;sex&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>a的值是：&#123;&#123;a&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;sayHello&quot;</span>&gt;</span>说话(Vue3所配置的——sayHello)<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t&lt;br&gt;</span><br><span class=\"line\">\t&lt;br&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;sayWelcome&quot;</span>&gt;</span>说话(Vue2所配置的——sayWelcome)<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t&lt;br&gt;</span><br><span class=\"line\">\t&lt;br&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;test1&quot;</span>&gt;</span>测试一下在Vue2的配置中去读取Vue3中的数据、方法<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t&lt;br&gt;</span><br><span class=\"line\">\t&lt;br&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;test2&quot;</span>&gt;</span>测试一下在Vue3的setup配置中去读取Vue2中的数据、方法<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"comment\">// import &#123;h&#125; from &#x27;vue&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">name</span>: <span class=\"string\">&#x27;App&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">data</span>(<span class=\"params\"></span>)</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">sex</span>:<span class=\"string\">&#x27;男&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">a</span>:<span class=\"number\">100</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">methods</span>: &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"function\"><span class=\"title\">sayWelcome</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\talert(<span class=\"string\">&#x27;欢迎来到尚硅谷学习&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"function\"><span class=\"title\">test1</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"built_in\">this</span>.sex)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"built_in\">this</span>.name)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"built_in\">this</span>.age)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"built_in\">this</span>.sayHello)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"comment\">//此处只是测试一下setup，暂时不考虑响应式的问题。</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"keyword\">async</span> <span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> name = <span class=\"string\">&#x27;张三&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> age = <span class=\"number\">18</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> a = <span class=\"number\">200</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//方法</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">sayHello</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\talert(<span class=\"string\">`我叫<span class=\"subst\">$&#123;name&#125;</span>，我<span class=\"subst\">$&#123;age&#125;</span>岁了，你好啊！`</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">test2</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(name)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(age)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(sayHello)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"built_in\">this</span>.sex)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"built_in\">this</span>.sayWelcome)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个对象（常用）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tname,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tage,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tsayHello,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\ttest2,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\ta</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个函数（渲染函数）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// return ()=&gt; h(&#x27;h1&#x27;,&#x27;尚硅谷&#x27;)</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<h2 id=\"2-ref函数\"><a href=\"#2-ref函数\" class=\"headerlink\" title=\"2.ref函数\"></a>2.ref函数</h2><ul>\n<li><p>作用: 定义一个响应式的数据</p>\n</li>\n<li><p>语法: <code>const xxx = ref(initValue)</code> </p>\n<ul>\n<li>创建一个包含响应式数据的<strong style=\"color:#DD5145\">引用对象（reference对象，简称ref对象）</strong>。</li>\n<li>JS中操作数据： <code>xxx.value</code></li>\n<li>模板中读取数据: 不需要.value，直接：<code>&lt;div&gt;&#123;&#123;xxx&#125;&#125;&lt;/div&gt;</code></li>\n</ul>\n</li>\n<li><p>备注：</p>\n<ul>\n<li>接收的数据可以是：基本类型、也可以是对象类型。</li>\n<li>基本类型的数据：响应式依然是靠<code>Object.defineProperty()</code>的<code>get</code>与<code>set</code>完成的。</li>\n<li>对象类型的数据：内部 <i style=\"color:gray;font-weight:bold\">“ 求助 ”</i> 了Vue3.0中的一个新函数—— <code>reactive</code>函数。</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>一个人的信息<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>姓名：&#123;&#123;name&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>年龄：&#123;&#123;age&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>工作种类：&#123;&#123;job.type&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>工作薪水：&#123;&#123;job.salary&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;changeInfo&quot;</span>&gt;</span>修改人的信息<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">import</span> &#123;ref&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">name</span>: <span class=\"string\">&#x27;App&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> name = ref(<span class=\"string\">&#x27;张三&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> age = ref(<span class=\"number\">18</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> job = ref(&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">type</span>:<span class=\"string\">&#x27;前端工程师&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">salary</span>:<span class=\"string\">&#x27;30K&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//方法</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">changeInfo</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"comment\">// name.value = &#x27;李四&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"comment\">// age.value = 48</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(job.value)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"comment\">// job.value.type = &#x27;UI设计师&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"comment\">// job.value.salary = &#x27;60K&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"comment\">// console.log(name,age)</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个对象（常用）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tname,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tage,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tjob,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tchangeInfo</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h2 id=\"3-reactive函数\"><a href=\"#3-reactive函数\" class=\"headerlink\" title=\"3.reactive函数\"></a>3.reactive函数</h2><ul>\n<li>作用: 定义一个<strong style=\"color:#DD5145\">对象类型</strong>的响应式数据（基本类型不要用它，要用<code>ref</code>函数）</li>\n<li>语法：<code>const 代理对象= reactive(源对象)</code>接收一个对象（或数组），返回一个<strong style=\"color:#DD5145\">代理对象（Proxy的实例对象，简称proxy对象）</strong></li>\n<li>reactive定义的响应式数据是“深层次的”。</li>\n<li>内部基于 ES6 的 Proxy 实现，通过代理对象操作源对象内部数据进行操作。</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>一个人的信息<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>姓名：&#123;&#123;person.name&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>年龄：&#123;&#123;person.age&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>工作种类：&#123;&#123;person.job.type&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>工作薪水：&#123;&#123;person.job.salary&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>爱好：&#123;&#123;person.hobby&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>测试的数据c：&#123;&#123;person.job.a.b.c&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;changeInfo&quot;</span>&gt;</span>修改人的信息<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">import</span> &#123;reactive&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">name</span>: <span class=\"string\">&#x27;App&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> person = reactive(&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">name</span>:<span class=\"string\">&#x27;张三&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">age</span>:<span class=\"number\">18</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">job</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t<span class=\"attr\">type</span>:<span class=\"string\">&#x27;前端工程师&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t<span class=\"attr\">salary</span>:<span class=\"string\">&#x27;30K&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t<span class=\"attr\">a</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t\t<span class=\"attr\">b</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t\t\t<span class=\"attr\">c</span>:<span class=\"number\">666</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">hobby</span>:[<span class=\"string\">&#x27;抽烟&#x27;</span>,<span class=\"string\">&#x27;喝酒&#x27;</span>,<span class=\"string\">&#x27;烫头&#x27;</span>]</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//方法</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">changeInfo</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson.name = <span class=\"string\">&#x27;李四&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson.age = <span class=\"number\">48</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson.job.type = <span class=\"string\">&#x27;UI设计师&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson.job.salary = <span class=\"string\">&#x27;60K&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson.job.a.b.c = <span class=\"number\">999</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson.hobby[<span class=\"number\">0</span>] = <span class=\"string\">&#x27;学习&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个对象（常用）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tchangeInfo</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n<h2 id=\"4-Vue3-0中的响应式原理\"><a href=\"#4-Vue3-0中的响应式原理\" class=\"headerlink\" title=\"4.Vue3.0中的响应式原理\"></a>4.Vue3.0中的响应式原理</h2><h3 id=\"vue2-x的响应式\"><a href=\"#vue2-x的响应式\" class=\"headerlink\" title=\"vue2.x的响应式\"></a>vue2.x的响应式</h3><ul>\n<li><p>实现原理：</p>\n<ul>\n<li><p>对象类型：通过<code>Object.defineProperty()</code>对属性的读取、修改进行拦截（数据劫持）。</p>\n</li>\n<li><p>数组类型：通过重写更新数组的一系列方法来实现拦截。（对数组的变更方法进行了包裹）。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">Object</span>.defineProperty(data, <span class=\"string\">&#x27;count&#x27;</span>, &#123;</span><br><span class=\"line\">    get () &#123;&#125;, </span><br><span class=\"line\">    set () &#123;&#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li><p>存在问题：</p>\n<ul>\n<li>新增属性、删除属性, 界面不会更新。</li>\n<li>直接通过下标修改数组, 界面不会自动更新。</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"Vue3-0的响应式\"><a href=\"#Vue3-0的响应式\" class=\"headerlink\" title=\"Vue3.0的响应式\"></a>Vue3.0的响应式</h3><ul>\n<li><p>实现原理: </p>\n<ul>\n<li><p>通过Proxy（代理）:  拦截对象中任意属性的变化, 包括：属性值的读写、属性的添加、属性的删除等。</p>\n</li>\n<li><p>通过Reflect（反射）:  对源对象的属性进行操作。</p>\n</li>\n<li><p>MDN文档中描述的Proxy与Reflect：</p>\n<ul>\n<li><p>Proxy：<a href=\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy\">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy</a></p>\n</li>\n<li><p>Reflect：<a href=\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Reflect\">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Reflect</a></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"built_in\">Proxy</span>(data, &#123;</span><br><span class=\"line\">\t<span class=\"comment\">// 拦截读取属性值</span></span><br><span class=\"line\">    get (target, prop) &#123;</span><br><span class=\"line\">    \t<span class=\"keyword\">return</span> <span class=\"built_in\">Reflect</span>.get(target, prop)</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"comment\">// 拦截设置属性值或添加新属性</span></span><br><span class=\"line\">    set (target, prop, value) &#123;</span><br><span class=\"line\">    \t<span class=\"keyword\">return</span> <span class=\"built_in\">Reflect</span>.set(target, prop, value)</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"comment\">// 拦截删除属性</span></span><br><span class=\"line\">    deleteProperty (target, prop) &#123;</span><br><span class=\"line\">    \t<span class=\"keyword\">return</span> <span class=\"built_in\">Reflect</span>.deleteProperty(target, prop)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">proxy.name = <span class=\"string\">&#x27;tom&#x27;</span>   </span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>代码：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"meta-keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Document<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text/javascript&quot;</span> &gt;</span><span class=\"javascript\"></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//源数据</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"keyword\">let</span> person = &#123;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t<span class=\"attr\">name</span>:<span class=\"string\">&#x27;张三&#x27;</span>,</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t<span class=\"attr\">age</span>:<span class=\"number\">18</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t&#125;</span></span><br><span class=\"line\"><span class=\"javascript\"></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//模拟Vue2中实现响应式</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//#region </span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">/* let p = &#123;&#125;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\tObject.defineProperty(p,&#x27;name&#x27;,&#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\tconfigurable:true,</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\tget()&#123; //有人读取name时调用</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\treturn person.name</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\tset(value)&#123; //有人修改name时调用</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\tconsole.log(&#x27;有人修改了name属性，我发现了，我要去更新界面！&#x27;)</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\tperson.name = value</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\tObject.defineProperty(p,&#x27;age&#x27;,&#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\tget()&#123; //有人读取age时调用</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\treturn person.age</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\tset(value)&#123; //有人修改age时调用</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\tconsole.log(&#x27;有人修改了age属性，我发现了，我要去更新界面！&#x27;)</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\tperson.age = value</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t&#125;) */</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//#endregion</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//模拟Vue3中实现响应式</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//#region </span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"keyword\">const</span> p = <span class=\"keyword\">new</span> <span class=\"built_in\">Proxy</span>(person,&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t<span class=\"comment\">//有人读取p的某个属性时调用</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t<span class=\"function\"><span class=\"title\">get</span>(<span class=\"params\">target,propName</span>)</span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">`有人读取了p身上的<span class=\"subst\">$&#123;propName&#125;</span>属性`</span>)</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t\t<span class=\"keyword\">return</span> <span class=\"built_in\">Reflect</span>.get(target,propName)</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t&#125;,</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t<span class=\"comment\">//有人修改p的某个属性、或给p追加某个属性时调用</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t<span class=\"function\"><span class=\"title\">set</span>(<span class=\"params\">target,propName,value</span>)</span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">`有人修改了p身上的<span class=\"subst\">$&#123;propName&#125;</span>属性，我要去更新界面了！`</span>)</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t\t<span class=\"built_in\">Reflect</span>.set(target,propName,value)</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t&#125;,</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t<span class=\"comment\">//有人删除p的某个属性时调用</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t<span class=\"function\"><span class=\"title\">deleteProperty</span>(<span class=\"params\">target,propName</span>)</span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">`有人删除了p身上的<span class=\"subst\">$&#123;propName&#125;</span>属性，我要去更新界面了！`</span>)</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t\t<span class=\"keyword\">return</span> <span class=\"built_in\">Reflect</span>.deleteProperty(target,propName)</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t&#125;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t&#125;)</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//#endregion</span></span></span><br><span class=\"line\"><span class=\"javascript\"></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"keyword\">let</span> obj = &#123;<span class=\"attr\">a</span>:<span class=\"number\">1</span>,<span class=\"attr\">b</span>:<span class=\"number\">2</span>&#125;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//通过Object.defineProperty去操作</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//#region </span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">/* try &#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\tObject.defineProperty(obj,&#x27;c&#x27;,&#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\tget()&#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\t\treturn 3</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\tObject.defineProperty(obj,&#x27;c&#x27;,&#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\tget()&#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\t\treturn 4</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t&#125; catch (error) &#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\tconsole.log(error)</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t&#125; */</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//#endregion</span></span></span><br><span class=\"line\"><span class=\"javascript\"></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//通过Reflect.defineProperty去操作</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//#region </span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">/* const x1 = Reflect.defineProperty(obj,&#x27;c&#x27;,&#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\tget()&#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\treturn 3</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\tconsole.log(x1)</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\tconst x2 = Reflect.defineProperty(obj,&#x27;c&#x27;,&#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\tget()&#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\treturn 4</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t&#125;) </span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\tif(x2)&#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\tconsole.log(&#x27;某某某操作成功了！&#x27;)</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t&#125;else&#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\tconsole.log(&#x27;某某某操作失败了！&#x27;)</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t&#125; */</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//#endregion</span></span></span><br><span class=\"line\"><span class=\"javascript\"></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">// console.log(&#x27;@@@&#x27;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"5-reactive对比ref\"><a href=\"#5-reactive对比ref\" class=\"headerlink\" title=\"5.reactive对比ref\"></a>5.reactive对比ref</h2><ul>\n<li>从定义数据角度对比：<ul>\n<li>ref用来定义：<strong style=\"color:#DD5145\">基本类型数据</strong>。</li>\n<li>reactive用来定义：<strong style=\"color:#DD5145\">对象（或数组）类型数据</strong>。</li>\n<li>备注：ref也可以用来定义<strong style=\"color:#DD5145\">对象（或数组）类型数据</strong>, 它内部会自动通过<code>reactive</code>转为<strong style=\"color:#DD5145\">代理对象</strong>。</li>\n</ul>\n</li>\n<li>从原理角度对比：<ul>\n<li>ref通过<code>Object.defineProperty()</code>的<code>get</code>与<code>set</code>来实现响应式（数据劫持）。</li>\n<li>reactive通过使用<strong style=\"color:#DD5145\">Proxy</strong>来实现响应式（数据劫持）, 并通过<strong style=\"color:#DD5145\">Reflect</strong>操作<strong style=\"color:orange\">源对象</strong>内部的数据。</li>\n</ul>\n</li>\n<li>从使用角度对比：<ul>\n<li>ref定义的数据：操作数据<strong style=\"color:#DD5145\">需要</strong><code>.value</code>，读取数据时模板中直接读取<strong style=\"color:#DD5145\">不需要</strong><code>.value</code>。</li>\n<li>reactive定义的数据：操作数据与读取数据：<strong style=\"color:#DD5145\">均不需要</strong><code>.value</code>。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"6-setup的两个注意点\"><a href=\"#6-setup的两个注意点\" class=\"headerlink\" title=\"6.setup的两个注意点\"></a>6.setup的两个注意点</h2><ul>\n<li><p>setup执行的时机</p>\n<ul>\n<li>在beforeCreate之前执行一次，this是undefined。</li>\n</ul>\n</li>\n<li><p>setup的参数</p>\n<ul>\n<li>props：值为对象，包含：组件外部传递过来，且组件内部声明接收了的属性。</li>\n<li>context：上下文对象<ul>\n<li>attrs: 值为对象，包含：组件外部传递过来，但没有在props配置中声明的属性, 相当于 <code>this.$attrs</code>。</li>\n<li>slots: 收到的插槽内容, 相当于 <code>this.$slots</code>。</li>\n<li>emit: 分发自定义事件的函数, 相当于 <code>this.$emit</code>。</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>代码：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>一个人的信息<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>姓名：&#123;&#123;person.name&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>年龄：&#123;&#123;person.age&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;test&quot;</span>&gt;</span>测试触发一下Demo组件的Hello事件<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">import</span> &#123;reactive&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">name</span>: <span class=\"string\">&#x27;Demo&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">props</span>:[<span class=\"string\">&#x27;msg&#x27;</span>,<span class=\"string\">&#x27;school&#x27;</span>],</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">emits</span>:[<span class=\"string\">&#x27;hello&#x27;</span>],</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\">props,context</span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// console.log(&#x27;---setup---&#x27;,props)</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// console.log(&#x27;---setup---&#x27;,context)</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// console.log(&#x27;---setup---&#x27;,context.attrs) //相当与Vue2中的$attrs</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// console.log(&#x27;---setup---&#x27;,context.emit) //触发自定义事件的。</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---setup---&#x27;</span>,context.slots) <span class=\"comment\">//插槽</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> person = reactive(&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">name</span>:<span class=\"string\">&#x27;张三&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">age</span>:<span class=\"number\">18</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//方法</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">test</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tcontext.emit(<span class=\"string\">&#x27;hello&#x27;</span>,<span class=\"number\">666</span>)   <span class=\"comment\">//注意写法</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个对象（常用）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\ttest</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n<h2 id=\"7-计算属性与监视\"><a href=\"#7-计算属性与监视\" class=\"headerlink\" title=\"7.计算属性与监视\"></a>7.计算属性与监视</h2><h3 id=\"1-computed函数\"><a href=\"#1-computed函数\" class=\"headerlink\" title=\"1.computed函数\"></a>1.computed函数</h3><ul>\n<li><p>与Vue2.x中computed配置功能一致</p>\n</li>\n<li><p>写法</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123;computed&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">\t<span class=\"comment\">//计算属性——简写</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> fullName = computed(<span class=\"function\">()=&gt;</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> person.firstName + <span class=\"string\">&#x27;-&#x27;</span> + person.lastName</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    <span class=\"comment\">//计算属性——完整</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> fullName = computed(&#123;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"title\">get</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> person.firstName + <span class=\"string\">&#x27;-&#x27;</span> + person.lastName</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"function\"><span class=\"title\">set</span>(<span class=\"params\">value</span>)</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> nameArr = value.split(<span class=\"string\">&#x27;-&#x27;</span>)</span><br><span class=\"line\">            person.firstName = nameArr[<span class=\"number\">0</span>]</span><br><span class=\"line\">            person.lastName = nameArr[<span class=\"number\">1</span>]</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h3 id=\"2-watch函数\"><a href=\"#2-watch函数\" class=\"headerlink\" title=\"2.watch函数\"></a>2.watch函数</h3><ul>\n<li><p>与Vue2.x中watch配置功能一致</p>\n</li>\n<li><p>两个小“坑”：</p>\n<ul>\n<li>监视reactive定义的响应式数据时：oldValue无法正确获取、强制开启了深度监视（deep配置失效）。</li>\n<li>监视reactive定义的响应式数据中某个属性时：deep配置有效。</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//情况一：监视ref定义的响应式数据</span></span><br><span class=\"line\">watch(sum,<span class=\"function\">(<span class=\"params\">newValue,oldValue</span>)=&gt;</span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;sum变化了&#x27;</span>,newValue,oldValue)</span><br><span class=\"line\">&#125;,&#123;<span class=\"attr\">immediate</span>:<span class=\"literal\">true</span>&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//情况二：监视多个ref定义的响应式数据</span></span><br><span class=\"line\">watch([sum,msg],<span class=\"function\">(<span class=\"params\">newValue,oldValue</span>)=&gt;</span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;sum或msg变化了&#x27;</span>,newValue,oldValue)</span><br><span class=\"line\">&#125;) </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* 情况三：监视reactive定义的响应式数据</span></span><br><span class=\"line\"><span class=\"comment\">\t\t\t若watch监视的是reactive定义的响应式数据，则无法正确获得oldValue！！</span></span><br><span class=\"line\"><span class=\"comment\">\t\t\t若watch监视的是reactive定义的响应式数据，则强制开启了深度监视 </span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\">watch(person,<span class=\"function\">(<span class=\"params\">newValue,oldValue</span>)=&gt;</span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;person变化了&#x27;</span>,newValue,oldValue)</span><br><span class=\"line\">&#125;,&#123;<span class=\"attr\">immediate</span>:<span class=\"literal\">true</span>,<span class=\"attr\">deep</span>:<span class=\"literal\">false</span>&#125;) <span class=\"comment\">//此处的deep配置不再奏效</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//情况四：监视reactive定义的响应式数据中的某个属性</span></span><br><span class=\"line\">watch(<span class=\"function\">()=&gt;</span>person.job,<span class=\"function\">(<span class=\"params\">newValue,oldValue</span>)=&gt;</span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;person的job变化了&#x27;</span>,newValue,oldValue)</span><br><span class=\"line\">&#125;,&#123;<span class=\"attr\">immediate</span>:<span class=\"literal\">true</span>,<span class=\"attr\">deep</span>:<span class=\"literal\">true</span>&#125;) </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//情况五：监视reactive定义的响应式数据中的某些属性</span></span><br><span class=\"line\">watch([<span class=\"function\">()=&gt;</span>person.job,<span class=\"function\">()=&gt;</span>person.name],<span class=\"function\">(<span class=\"params\">newValue,oldValue</span>)=&gt;</span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;person的job变化了&#x27;</span>,newValue,oldValue)</span><br><span class=\"line\">&#125;,&#123;<span class=\"attr\">immediate</span>:<span class=\"literal\">true</span>,<span class=\"attr\">deep</span>:<span class=\"literal\">true</span>&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//特殊情况</span></span><br><span class=\"line\">watch(<span class=\"function\">()=&gt;</span>person.job,<span class=\"function\">(<span class=\"params\">newValue,oldValue</span>)=&gt;</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;person的job变化了&#x27;</span>,newValue,oldValue)</span><br><span class=\"line\">&#125;,&#123;<span class=\"attr\">deep</span>:<span class=\"literal\">true</span>&#125;) <span class=\"comment\">//此处由于监视的是reactive素定义的对象中的某个属性，所以deep配置有效</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>全部代码：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>当前求和为：&#123;&#123;sum&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;sum++&quot;</span>&gt;</span>点我+1<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t&lt;hr&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>当前的信息为：&#123;&#123;msg&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;msg+=&#x27;！&#x27;&quot;</span>&gt;</span>修改信息<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t&lt;hr&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>姓名：&#123;&#123;person.name&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>年龄：&#123;&#123;person.age&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>薪资：&#123;&#123;person.job.j1.salary&#125;&#125;K<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;person.name+=&#x27;~&#x27;&quot;</span>&gt;</span>修改姓名<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;person.age++&quot;</span>&gt;</span>增长年龄<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;person.job.j1.salary++&quot;</span>&gt;</span>涨薪<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">import</span> &#123;ref,reactive,watch&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">name</span>: <span class=\"string\">&#x27;Demo&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> sum = ref(<span class=\"number\">0</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> msg = ref(<span class=\"string\">&#x27;你好啊&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> person = reactive(&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">name</span>:<span class=\"string\">&#x27;张三&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">age</span>:<span class=\"number\">18</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">job</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t<span class=\"attr\">j1</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t\t<span class=\"attr\">salary</span>:<span class=\"number\">20</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//情况一：监视ref所定义的一个响应式数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">/* watch(sum,(newValue,oldValue)=&gt;&#123;</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tconsole.log(&#x27;sum变了&#x27;,newValue,oldValue)</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;,&#123;immediate:true&#125;) */</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//情况二：监视ref所定义的多个响应式数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">/* watch([sum,msg],(newValue,oldValue)=&gt;&#123;</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tconsole.log(&#x27;sum或msg变了&#x27;,newValue,oldValue)</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;,&#123;immediate:true&#125;) */</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">/* </span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t情况三：监视reactive所定义的一个响应式数据的全部属性</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t\t1.注意：此处无法正确的获取oldValue</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t\t2.注意：强制开启了深度监视（deep配置无效）</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t*/</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">/* watch(person,(newValue,oldValue)=&gt;&#123;</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tconsole.log(&#x27;person变化了&#x27;,newValue,oldValue)</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;,&#123;deep:false&#125;) //此处的deep配置无效 */</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//情况四：监视reactive所定义的一个响应式数据中的某个属性</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">/* watch(()=&gt;person.name,(newValue,oldValue)=&gt;&#123;</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tconsole.log(&#x27;person的name变化了&#x27;,newValue,oldValue)</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)  */</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//情况五：监视reactive所定义的一个响应式数据中的某些属性</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">/* watch([()=&gt;person.name,()=&gt;person.age],(newValue,oldValue)=&gt;&#123;</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tconsole.log(&#x27;person的name或age变化了&#x27;,newValue,oldValue)</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)  */</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//特殊情况</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">/* watch(()=&gt;person.job,(newValue,oldValue)=&gt;&#123;</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tconsole.log(&#x27;person的job变化了&#x27;,newValue,oldValue)</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;,&#123;deep:true&#125;) //此处由于监视的是reactive素定义的对象中的某个属性，所以deep配置有效 */</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个对象（常用）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tsum,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tmsg,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n<h3 id=\"3-watchEffect函数\"><a href=\"#3-watchEffect函数\" class=\"headerlink\" title=\"3.watchEffect函数\"></a>3.watchEffect函数</h3><ul>\n<li><p>watch的套路是：既要指明监视的属性，也要指明监视的回调。</p>\n</li>\n<li><p>watchEffect的套路是：不用指明监视哪个属性，监视的回调中用到哪个属性，那就监视哪个属性。</p>\n</li>\n<li><p>watchEffect有点像computed：</p>\n<ul>\n<li>但computed注重的计算出来的值（回调函数的返回值），所以必须要写返回值。</li>\n<li>而watchEffect更注重的是过程（回调函数的函数体），所以不用写返回值。</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//watchEffect所指定的回调中用到的数据只要发生变化，则直接重新执行回调。</span></span><br><span class=\"line\">watchEffect(<span class=\"function\">()=&gt;</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> x1 = sum.value</span><br><span class=\"line\">    <span class=\"keyword\">const</span> x2 = person.age</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;watchEffect配置的回调执行了&#x27;</span>)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>当前求和为：&#123;&#123;sum&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;sum++&quot;</span>&gt;</span>点我+1<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t&lt;hr&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>当前的信息为：&#123;&#123;msg&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;msg+=&#x27;！&#x27;&quot;</span>&gt;</span>修改信息<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t&lt;hr&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>姓名：&#123;&#123;person.name&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>年龄：&#123;&#123;person.age&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>薪资：&#123;&#123;person.job.j1.salary&#125;&#125;K<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;person.name+=&#x27;~&#x27;&quot;</span>&gt;</span>修改姓名<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;person.age++&quot;</span>&gt;</span>增长年龄<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;person.job.j1.salary++&quot;</span>&gt;</span>涨薪<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">import</span> &#123;ref,reactive,watch,watchEffect&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">name</span>: <span class=\"string\">&#x27;Demo&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> sum = ref(<span class=\"number\">0</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> msg = ref(<span class=\"string\">&#x27;你好啊&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> person = reactive(&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">name</span>:<span class=\"string\">&#x27;张三&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">age</span>:<span class=\"number\">18</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">job</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t<span class=\"attr\">j1</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t\t<span class=\"attr\">salary</span>:<span class=\"number\">20</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//监视</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">/* watch(sum,(newValue,oldValue)=&gt;&#123;</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tconsole.log(&#x27;sum的值变化了&#x27;,newValue,oldValue)</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;,&#123;immediate:true&#125;) */</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\twatchEffect(<span class=\"function\">()=&gt;</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"keyword\">const</span> x1 = sum.value</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"keyword\">const</span> x2 = person.job.j1.salary</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;watchEffect所指定的回调执行了&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个对象（常用）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tsum,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tmsg,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n<h2 id=\"8-生命周期\"><a href=\"#8-生命周期\" class=\"headerlink\" title=\"8.生命周期\"></a>8.生命周期</h2><p>Vue2生命周期</p>\n<p><img src=\"https://cn.vuejs.org/images/lifecycle.png\" alt=\"\"></p>\n<p>Vue3生命周期</p>\n<p><img src=\"https://v3.cn.vuejs.org/images/lifecycle.svg\" alt=\"\"></p>\n<ul>\n<li>Vue3.0中可以继续使用Vue2.x中的生命周期钩子，但有有两个被更名：<ul>\n<li><code>beforeDestroy</code>改名为 <code>beforeUnmount</code></li>\n<li><code>destroyed</code>改名为 <code>unmounted</code></li>\n</ul>\n</li>\n<li>Vue3.0也提供了 Composition API 形式的生命周期钩子，与Vue2.x中钩子对应关系如下：<ul>\n<li><code>beforeCreate</code>===&gt;<code>setup()</code></li>\n<li><code>created</code>=======&gt;<code>setup()</code></li>\n<li><code>beforeMount</code> ===&gt;<code>onBeforeMount</code></li>\n<li><code>mounted</code>=======&gt;<code>onMounted</code></li>\n<li><code>beforeUpdate</code>===&gt;<code>onBeforeUpdate</code></li>\n<li><code>updated</code> =======&gt;<code>onUpdated</code></li>\n<li><code>beforeUnmount</code> ==&gt;<code>onBeforeUnmount</code></li>\n<li><code>unmounted</code> =====&gt;<code>onUnmounted</code></li>\n</ul>\n</li>\n</ul>\n<p>通过Composition API 形式的生命周期钩子函数优先级高于通过配置项的生命周期钩子</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>当前求和为：&#123;&#123;sum&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;sum++&quot;</span>&gt;</span>点我+1<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">import</span> &#123;ref,onBeforeMount,onMounted,onBeforeUpdate,onUpdated,onBeforeUnmount,onUnmounted&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">name</span>: <span class=\"string\">&#x27;Demo&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---setup---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> sum = ref(<span class=\"number\">0</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//通过组合式API的形式去使用生命周期钩子</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\tonBeforeMount(<span class=\"function\">()=&gt;</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---onBeforeMount---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\tonMounted(<span class=\"function\">()=&gt;</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---onMounted---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\tonBeforeUpdate(<span class=\"function\">()=&gt;</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---onBeforeUpdate---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\tonUpdated(<span class=\"function\">()=&gt;</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---onUpdated---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\tonBeforeUnmount(<span class=\"function\">()=&gt;</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---onBeforeUnmount---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\tonUnmounted(<span class=\"function\">()=&gt;</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---onUnmounted---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个对象（常用）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;sum&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"comment\">//通过配置项的形式使用生命周期钩子</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"comment\">//#region </span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">beforeCreate</span>(<span class=\"params\"></span>)</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---beforeCreate---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">created</span>(<span class=\"params\"></span>)</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---created---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">beforeMount</span>(<span class=\"params\"></span>)</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---beforeMount---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">mounted</span>(<span class=\"params\"></span>)</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---mounted---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">beforeUpdate</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---beforeUpdate---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">updated</span>(<span class=\"params\"></span>)</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---updated---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">beforeUnmount</span>(<span class=\"params\"></span>)</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---beforeUnmount---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">unmounted</span>(<span class=\"params\"></span>)</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---unmounted---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"comment\">//#endregion</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n<h2 id=\"9-自定义hook函数\"><a href=\"#9-自定义hook函数\" class=\"headerlink\" title=\"9.自定义hook函数\"></a>9.自定义hook函数</h2><ul>\n<li>什么是hook？—— 本质是一个函数，把setup函数中使用的Composition API进行了封装。</li>\n<li>类似于vue2.x中的mixin。</li>\n<li>自定义hook的优势: 复用代码, 让setup中的逻辑更清楚易懂。</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>当前求和为：&#123;&#123;sum&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;sum++&quot;</span>&gt;</span>点我+1<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t&lt;hr&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>当前点击时鼠标的坐标为：x：&#123;&#123;point.x&#125;&#125;，y：&#123;&#123;point.y&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">import</span> &#123;ref&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">import</span> usePoint <span class=\"keyword\">from</span> <span class=\"string\">&#x27;../hooks/usePoint&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">name</span>: <span class=\"string\">&#x27;Demo&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> sum = ref(<span class=\"number\">0</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> point = usePoint()</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个对象（常用）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;sum,point&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n<p>hooks</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123;reactive,onMounted,onBeforeUnmount&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//实现鼠标“打点”相关的数据</span></span><br><span class=\"line\">\t<span class=\"keyword\">let</span> point = reactive(&#123;</span><br><span class=\"line\">\t\t<span class=\"attr\">x</span>:<span class=\"number\">0</span>,</span><br><span class=\"line\">\t\t<span class=\"attr\">y</span>:<span class=\"number\">0</span></span><br><span class=\"line\">\t&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//实现鼠标“打点”相关的方法</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">savePoint</span>(<span class=\"params\">event</span>)</span>&#123;</span><br><span class=\"line\">\t\tpoint.x = event.pageX</span><br><span class=\"line\">\t\tpoint.y = event.pageY</span><br><span class=\"line\">\t\t<span class=\"built_in\">console</span>.log(event.pageX,event.pageY)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//实现鼠标“打点”相关的生命周期钩子</span></span><br><span class=\"line\">\tonMounted(<span class=\"function\">()=&gt;</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">window</span>.addEventListener(<span class=\"string\">&#x27;click&#x27;</span>,savePoint)</span><br><span class=\"line\">\t&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">\tonBeforeUnmount(<span class=\"function\">()=&gt;</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">window</span>.removeEventListener(<span class=\"string\">&#x27;click&#x27;</span>,savePoint)</span><br><span class=\"line\">\t&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> point</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://qny.aqingya.cn/img/20220118180338.png\" alt=\"\"></p>\n<p><img src=\"https://qny.aqingya.cn/img/20220118180458.png\" alt=\"\"></p>\n<h2 id=\"10-toRef\"><a href=\"#10-toRef\" class=\"headerlink\" title=\"10.toRef\"></a>10.toRef</h2><ul>\n<li>作用：创建一个 ref 对象，其value值指向另一个对象中的某个属性。</li>\n<li>语法：<code>const name = toRef(person,&#39;name&#39;)</code></li>\n<li>应用:   要将响应式对象中的某个属性单独提供给外部使用时。</li>\n</ul>\n<ul>\n<li>扩展：<code>toRefs</code> 与<code>toRef</code>功能一致，但可以批量创建多个 ref 对象，语法：<code>toRefs(person)</code></li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>&#123;&#123;person&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>姓名：&#123;&#123;name&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>年龄：&#123;&#123;age&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>薪资：&#123;&#123;job.j1.salary&#125;&#125;K<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;name+=&#x27;~&#x27;&quot;</span>&gt;</span>修改姓名<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;age++&quot;</span>&gt;</span>增长年龄<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;job.j1.salary++&quot;</span>&gt;</span>涨薪<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">import</span> &#123;ref,reactive,toRef,toRefs&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">name</span>: <span class=\"string\">&#x27;Demo&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> person = reactive(&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">name</span>:<span class=\"string\">&#x27;张三&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">age</span>:<span class=\"number\">18</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">job</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t<span class=\"attr\">j1</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t\t<span class=\"attr\">salary</span>:<span class=\"number\">20</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// const name1 = person.name</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// console.log(&#x27;%%%&#x27;,name1)</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// const name2 = toRef(person,&#x27;name&#x27;)</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// console.log(&#x27;####&#x27;,name2)</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">const</span> x = toRefs(person)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;******&#x27;</span>,x)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个对象（常用）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"comment\">// name:toRef(person,&#x27;name&#x27;),</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"comment\">// age:toRef(person,&#x27;age&#x27;),</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"comment\">// salary:toRef(person.job.j1,&#x27;salary&#x27;),</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t...toRefs(person)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n<h1 id=\"三、其它-Composition-API\"><a href=\"#三、其它-Composition-API\" class=\"headerlink\" title=\"三、其它 Composition API\"></a>三、其它 Composition API</h1><h2 id=\"1-shallowReactive-与-shallowRef\"><a href=\"#1-shallowReactive-与-shallowRef\" class=\"headerlink\" title=\"1.shallowReactive 与 shallowRef\"></a>1.shallowReactive 与 shallowRef</h2><ul>\n<li>shallowReactive：只处理对象最外层属性的响应式（浅响应式）。</li>\n<li><p>shallowRef：只处理基本数据类型的响应式, 不进行对象的响应式处理。</p>\n</li>\n<li><p>什么时候使用?</p>\n<ul>\n<li>如果有一个对象数据，结构比较深, 但变化时只是外层属性变化 ===&gt; shallowReactive。</li>\n<li>如果有一个对象数据，后续功能不会修改该对象中的属性，而是生新的对象来替换 ===&gt; shallowRef。</li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>当前的x.y值是：&#123;&#123;x.y&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;x=&#123;y:888&#125;&quot;</span>&gt;</span>点我替换x<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;x.y++&quot;</span>&gt;</span>点我x.y++<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t&lt;hr&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>&#123;&#123;person&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>姓名：&#123;&#123;name&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>年龄：&#123;&#123;age&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>薪资：&#123;&#123;job.j1.salary&#125;&#125;K<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;name+=&#x27;~&#x27;&quot;</span>&gt;</span>修改姓名<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;age++&quot;</span>&gt;</span>增长年龄<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;job.j1.salary++&quot;</span>&gt;</span>涨薪<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">import</span> &#123;ref,reactive,toRef,toRefs,shallowReactive,shallowRef&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">name</span>: <span class=\"string\">&#x27;Demo&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// let person = shallowReactive(&#123; //只考虑第一层数据的响应式</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> person = reactive(&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">name</span>:<span class=\"string\">&#x27;张三&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">age</span>:<span class=\"number\">18</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">job</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t<span class=\"attr\">j1</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t\t<span class=\"attr\">salary</span>:<span class=\"number\">20</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> x = shallowRef(&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">y</span>:<span class=\"number\">0</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;******&#x27;</span>,x)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个对象（常用）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tx,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t...toRefs(person)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"2-readonly-与-shallowReadonly\"><a href=\"#2-readonly-与-shallowReadonly\" class=\"headerlink\" title=\"2.readonly 与 shallowReadonly\"></a>2.readonly 与 shallowReadonly</h2><ul>\n<li>readonly: 让一个响应式数据变为只读的（深只读）。</li>\n<li>shallowReadonly：让一个响应式数据变为只读的（浅只读）。</li>\n<li>应用场景: 1、不希望数据被修改时；2、有可能这个数据是别人给你的，别人不希望你修改这个数据；</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>当前求和为：&#123;&#123;sum&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;sum++&quot;</span>&gt;</span>点我++<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t&lt;hr&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>姓名：&#123;&#123;name&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>年龄：&#123;&#123;age&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>薪资：&#123;&#123;job.j1.salary&#125;&#125;K<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;name+=&#x27;~&#x27;&quot;</span>&gt;</span>修改姓名<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;age++&quot;</span>&gt;</span>增长年龄<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;job.j1.salary++&quot;</span>&gt;</span>涨薪<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">import</span> &#123;ref,reactive,toRefs,readonly,shallowReadonly&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">name</span>: <span class=\"string\">&#x27;Demo&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> sum = ref(<span class=\"number\">0</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> person = reactive(&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">name</span>:<span class=\"string\">&#x27;张三&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">age</span>:<span class=\"number\">18</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">job</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t<span class=\"attr\">j1</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t\t<span class=\"attr\">salary</span>:<span class=\"number\">20</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\tperson = readonly(person)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// person = shallowReadonly(person)</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// sum = readonly(sum)</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// sum = shallowReadonly(sum)</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个对象（常用）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tsum,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t...toRefs(person)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n<h2 id=\"3-toRaw-与-markRaw\"><a href=\"#3-toRaw-与-markRaw\" class=\"headerlink\" title=\"3.toRaw 与 markRaw\"></a>3.toRaw 与 markRaw</h2><ul>\n<li>toRaw：(可以理解为还原)<ul>\n<li>作用：将一个由<code>reactive</code>生成的<strong style=\"color:orange\">响应式对象</strong>转为<strong style=\"color:orange\">普通对象</strong>。</li>\n<li>使用场景：用于读取响应式对象对应的普通对象，对这个普通对象的所有操作，不会引起页面更新。</li>\n</ul>\n</li>\n<li>markRaw：<ul>\n<li>作用：标记一个对象，使其永远不会再成为响应式对象。</li>\n<li>应用场景:<ol>\n<li>有些值不应被设置为响应式的，例如复杂的第三方类库等。</li>\n<li>当渲染具有不可变数据源的大列表时，跳过响应式转换可以提高性能。</li>\n</ol>\n</li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>当前求和为：&#123;&#123;sum&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;sum++&quot;</span>&gt;</span>点我++<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t&lt;hr&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>姓名：&#123;&#123;name&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>年龄：&#123;&#123;age&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>薪资：&#123;&#123;job.j1.salary&#125;&#125;K<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h3</span> <span class=\"attr\">v-show</span>=<span class=\"string\">&quot;person.car&quot;</span>&gt;</span>座驾信息：&#123;&#123;person.car&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;name+=&#x27;~&#x27;&quot;</span>&gt;</span>修改姓名<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;age++&quot;</span>&gt;</span>增长年龄<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;job.j1.salary++&quot;</span>&gt;</span>涨薪<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;showRawPerson&quot;</span>&gt;</span>输出最原始的person<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;addCar&quot;</span>&gt;</span>给人添加一台车<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;person.car.name+=&#x27;!&#x27;&quot;</span>&gt;</span>换车名<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;changePrice&quot;</span>&gt;</span>换价格<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">import</span> &#123;ref,reactive,toRefs,toRaw,markRaw&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">name</span>: <span class=\"string\">&#x27;Demo&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> sum = ref(<span class=\"number\">0</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> person = reactive(&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">name</span>:<span class=\"string\">&#x27;张三&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">age</span>:<span class=\"number\">18</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">job</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t<span class=\"attr\">j1</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t\t<span class=\"attr\">salary</span>:<span class=\"number\">20</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">showRawPerson</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"keyword\">const</span> p = toRaw(person)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tp.age++</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(p)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">addCar</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"keyword\">let</span> car = &#123;<span class=\"attr\">name</span>:<span class=\"string\">&#x27;奔驰&#x27;</span>,<span class=\"attr\">price</span>:<span class=\"number\">40</span>&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson.car = markRaw(car)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">changePrice</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson.car.price++</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(person.car.price)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个对象（常用）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tsum,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t...toRefs(person),</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tshowRawPerson,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\taddCar,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tchangePrice</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n<h2 id=\"4-customRef\"><a href=\"#4-customRef\" class=\"headerlink\" title=\"4.customRef\"></a>4.customRef</h2><ul>\n<li><p>作用：创建一个自定义的 ref，并对其依赖项跟踪和更新触发进行显式控制。</p>\n</li>\n<li><p>实现防抖效果：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t&lt;input type=&quot;text&quot; v-model=&quot;keyword&quot;&gt;</span><br><span class=\"line\">\t&lt;h3&gt;&#123;&#123;keyword&#125;&#125;&lt;/h3&gt;</span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\">\timport &#123;ref,customRef&#125; from &#x27;vue&#x27;</span><br><span class=\"line\">\texport default &#123;</span><br><span class=\"line\">\t\tname:&#x27;Demo&#x27;,</span><br><span class=\"line\">\t\tsetup()&#123;</span><br><span class=\"line\">\t\t\t// let keyword = ref(&#x27;hello&#x27;) //使用Vue准备好的内置ref</span><br><span class=\"line\">\t\t\t//自定义一个myRef</span><br><span class=\"line\">\t\t\tfunction myRef(value,delay)&#123;</span><br><span class=\"line\">\t\t\t\tlet timer</span><br><span class=\"line\">\t\t\t\t//通过customRef去实现自定义</span><br><span class=\"line\">\t\t\t\treturn customRef((track,trigger)=&gt;&#123;</span><br><span class=\"line\">\t\t\t\t\treturn&#123;</span><br><span class=\"line\">\t\t\t\t\t\tget()&#123;</span><br><span class=\"line\">\t\t\t\t\t\t\ttrack() //告诉Vue这个value值是需要被“追踪”的</span><br><span class=\"line\">\t\t\t\t\t\t\treturn value</span><br><span class=\"line\">\t\t\t\t\t\t&#125;,</span><br><span class=\"line\">\t\t\t\t\t\tset(newValue)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t\tclearTimeout(timer)</span><br><span class=\"line\">\t\t\t\t\t\t\ttimer = setTimeout(()=&gt;&#123;</span><br><span class=\"line\">\t\t\t\t\t\t\t\tvalue = newValue</span><br><span class=\"line\">\t\t\t\t\t\t\t\ttrigger() //告诉Vue去更新界面</span><br><span class=\"line\">\t\t\t\t\t\t\t&#125;,delay)</span><br><span class=\"line\">\t\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t&#125;)</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\tlet keyword = myRef(&#x27;hello&#x27;,500) //使用程序员自定义的ref</span><br><span class=\"line\">\t\t\treturn &#123;</span><br><span class=\"line\">\t\t\t\tkeyword</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h2 id=\"5-provide-与-inject\"><a href=\"#5-provide-与-inject\" class=\"headerlink\" title=\"5.provide 与 inject\"></a>5.provide 与 inject</h2><p><img src=\"https://v3.cn.vuejs.org/images/components_provide.png\" style=\"width:300px\" /></p>\n<ul>\n<li><p>作用：实现<strong style=\"color:#DD5145\">祖与后代组件间</strong>通信</p>\n</li>\n<li><p>套路：父组件有一个 <code>provide</code> 选项来提供数据，后代组件有一个 <code>inject</code> 选项来开始使用这些数据</p>\n</li>\n<li><p>具体写法：</p>\n<ol>\n<li><p>祖组件中：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;\t......    <span class=\"keyword\">let</span> car = reactive(&#123;<span class=\"attr\">name</span>:<span class=\"string\">&#x27;奔驰&#x27;</span>,<span class=\"attr\">price</span>:<span class=\"string\">&#x27;40万&#x27;</span>&#125;)    provide(<span class=\"string\">&#x27;car&#x27;</span>,car)    ......&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>后代组件中：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\">props,context</span>)</span>&#123;\t......    <span class=\"keyword\">const</span> car = inject(<span class=\"string\">&#x27;car&#x27;</span>)    <span class=\"keyword\">return</span> &#123;car&#125;\t......&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n</li>\n</ul>\n<h2 id=\"6-响应式数据的判断\"><a href=\"#6-响应式数据的判断\" class=\"headerlink\" title=\"6.响应式数据的判断\"></a>6.响应式数据的判断</h2><ul>\n<li>isRef: 检查一个值是否为一个 ref 对象</li>\n<li>isReactive: 检查一个对象是否是由 <code>reactive</code> 创建的响应式代理</li>\n<li>isReadonly: 检查一个对象是否是由 <code>readonly</code> 创建的只读代理</li>\n<li>isProxy: 检查一个对象是否是由 <code>reactive</code> 或者 <code>readonly</code> 方法创建的代理</li>\n</ul>\n<h1 id=\"四、Composition-API-的优势\"><a href=\"#四、Composition-API-的优势\" class=\"headerlink\" title=\"四、Composition API 的优势\"></a>四、Composition API 的优势</h1><h2 id=\"1-Options-API-存在的问题\"><a href=\"#1-Options-API-存在的问题\" class=\"headerlink\" title=\"1.Options API 存在的问题\"></a>1.Options API 存在的问题</h2><p>使用传统OptionsAPI中，新增或者修改一个需求，就需要分别在data，methods，computed里修改 。</p>\n<p><img src=\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f84e4e2c02424d9a99862ade0a2e4114~tplv-k3u1fbpfcp-watermark.image\" alt=\"\"></p>\n<p><img src=\"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e5ac7e20d1784887a826f6360768a368~tplv-k3u1fbpfcp-watermark.image\" alt=\"\"></p>\n<h2 id=\"2-Composition-API-的优势\"><a href=\"#2-Composition-API-的优势\" class=\"headerlink\" title=\"2.Composition API 的优势\"></a>2.Composition API 的优势</h2><p>我们可以更加优雅的组织我们的代码，函数。让相关功能的代码更加有序的组织在一起。</p>\n<p><img src=\"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6cc55165c0e34069a75fe36f8712eb80~tplv-k3u1fbpfcp-watermark.image\" alt=\"\"></p>\n<p><img src=\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bc0be8211fc54b6c941c036791ba4efe~tplv-k3u1fbpfcp-watermark.image\" alt=\"\"></p>\n<h1 id=\"五、新的组件\"><a href=\"#五、新的组件\" class=\"headerlink\" title=\"五、新的组件\"></a>五、新的组件</h1><h2 id=\"1-Fragment\"><a href=\"#1-Fragment\" class=\"headerlink\" title=\"1.Fragment\"></a>1.Fragment</h2><ul>\n<li>在Vue2中: 组件必须有一个根标签</li>\n<li>在Vue3中: 组件可以没有根标签, 内部会将多个标签包含在一个Fragment虚拟元素中</li>\n<li>好处: 减少标签层级, 减小内存占用</li>\n</ul>\n<h2 id=\"2-Teleport\"><a href=\"#2-Teleport\" class=\"headerlink\" title=\"2.Teleport\"></a>2.Teleport</h2><ul>\n<li><p>什么是Teleport？—— <code>Teleport</code> 是一种能够将我们的<strong style=\"color:#DD5145\">组件html结构</strong>移动到指定位置的技术。</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">template</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;isShow = true&quot;</span>&gt;</span>点我弹个窗<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">teleport</span> <span class=\"attr\">to</span>=<span class=\"string\">&quot;body&quot;</span>&gt;</span></span><br><span class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">v-if</span>=<span class=\"string\">&quot;isShow&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;mask&quot;</span>&gt;</span></span><br><span class=\"line\">\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;dialog&quot;</span>&gt;</span></span><br><span class=\"line\">\t\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>我是一个弹窗<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\">\t\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>一些内容<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span><br><span class=\"line\">\t\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>一些内容<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span><br><span class=\"line\">\t\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>一些内容<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span><br><span class=\"line\">\t\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;isShow = false&quot;</span>&gt;</span>关闭弹窗<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\">\t\t\t\t<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">\t\t\t<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;/<span class=\"name\">teleport</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">template</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h2 id=\"3-Suspense\"><a href=\"#3-Suspense\" class=\"headerlink\" title=\"3.Suspense\"></a>3.Suspense</h2><ul>\n<li><p>等待异步组件时渲染一些额外内容，让应用有更好的用户体验</p>\n</li>\n<li><p>使用步骤：</p>\n<ul>\n<li><p>异步引入组件</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123;defineAsyncComponent&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span><span class=\"keyword\">const</span> Child = defineAsyncComponent(<span class=\"function\">()=&gt;</span><span class=\"keyword\">import</span>(<span class=\"string\">&#x27;./components/Child.vue&#x27;</span>))</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>使用<code>Suspense</code>包裹组件，并配置好<code>default</code> 与 <code>fallback</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;\t&lt;div class=&quot;app&quot;&gt;\t\t&lt;h3&gt;我是App组件&lt;/h3&gt;\t\t&lt;Suspense&gt;\t\t\t&lt;template v-slot:default&gt;\t\t\t\t&lt;Child/&gt;\t\t\t&lt;/template&gt;\t\t\t&lt;template v-slot:fallback&gt;\t\t\t\t&lt;h3&gt;加载中.....&lt;/h3&gt;\t\t\t&lt;/template&gt;\t\t&lt;/Suspense&gt;\t&lt;/div&gt;&lt;/template&gt;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"六、其他\"><a href=\"#六、其他\" class=\"headerlink\" title=\"六、其他\"></a>六、其他</h1><h2 id=\"1-全局API的转移\"><a href=\"#1-全局API的转移\" class=\"headerlink\" title=\"1.全局API的转移\"></a>1.全局API的转移</h2><ul>\n<li><p>Vue 2.x 有许多全局 API 和配置。</p>\n<ul>\n<li><p>例如：注册全局组件、注册全局指令等。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//注册全局组件Vue.component(&#x27;MyButton&#x27;, &#123;  data: () =&gt; (&#123;    count: 0  &#125;),  template: &#x27;&lt;button @click=&quot;count++&quot;&gt;Clicked &#123;&#123; count &#125;&#125; times.&lt;/button&gt;&#x27;&#125;)//注册全局指令Vue.directive(&#x27;focus&#x27;, &#123;  inserted: el =&gt; el.focus()&#125;</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li><p>Vue3.0中对这些API做出了调整：</p>\n<ul>\n<li><p>将全局的API，即：<code>Vue.xxx</code>调整到应用实例（<code>app</code>）上</p>\n<p>| 2.x 全局 API（<code>Vue</code>） | 3.x 实例 API (<code>app</code>)                        |<br>| ————————————- | —————————————————————- |<br>| Vue.config.xxxx           | app.config.xxxx                             |<br>| Vue.config.productionTip  | <strong style=\"color:#DD5145\">移除</strong> |<br>| Vue.component             | app.component                               |<br>| Vue.directive             | app.directive                               |<br>| Vue.mixin                 | app.mixin                                   |<br>| Vue.use                   | app.use                                     |<br>| Vue.prototype             | app.config.globalProperties                 |</p>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"2-其他改变\"><a href=\"#2-其他改变\" class=\"headerlink\" title=\"2.其他改变\"></a>2.其他改变</h2><ul>\n<li><p>data选项应始终被声明为一个函数。</p>\n</li>\n<li><p>过度类名的更改：</p>\n<ul>\n<li><p>Vue2.x写法</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.v-enter</span>,<span class=\"selector-class\">.v-leave-to</span> &#123;  <span class=\"attribute\">opacity</span>: <span class=\"number\">0</span>;&#125;<span class=\"selector-class\">.v-leave</span>,<span class=\"selector-class\">.v-enter-to</span> &#123;  <span class=\"attribute\">opacity</span>: <span class=\"number\">1</span>;&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Vue3.x写法</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.v-enter-from</span>,<span class=\"selector-class\">.v-leave-to</span> &#123;  <span class=\"attribute\">opacity</span>: <span class=\"number\">0</span>;&#125;<span class=\"selector-class\">.v-leave-from</span>,<span class=\"selector-class\">.v-enter-to</span> &#123;  <span class=\"attribute\">opacity</span>: <span class=\"number\">1</span>;&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li><p><strong style=\"color:#DD5145\">移除</strong>keyCode作为 v-on 的修饰符，同时也不再支持<code>config.keyCodes</code> （自定义按键别名）</p>\n</li>\n<li><p><strong style=\"color:#DD5145\">移除</strong><code>v-on.native</code>修饰符</p>\n<ul>\n<li><p>父组件中绑定事件</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;my-component  v-on:close=&quot;handleComponentEvent&quot;  v-on:click=&quot;handleNativeClickEvent&quot;/&gt;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>子组件中声明自定义事件</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script&gt;  export default &#123;    emits: [&#x27;close&#x27;]  &#125;&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li><p><strong style=\"color:#DD5145\">移除</strong>过滤器（filter）</p>\n<blockquote>\n<p>过滤器虽然这看起来很方便，但它需要一个自定义语法，打破大括号内表达式是 “只是 JavaScript” 的假设，这不仅有学习成本，而且有实现成本！建议用方法调用或计算属性去替换过滤器。</p>\n</blockquote>\n</li>\n<li><p>……</p>\n</li>\n</ul>\n","more":"<p><img src=\"https://user-images.githubusercontent.com/499550/93624428-53932780-f9ae-11ea-8d16-af949e16a09f.png\" style=\"width:200px\" /></p>\n<h2 id=\"1-Vue3简介\"><a href=\"#1-Vue3简介\" class=\"headerlink\" title=\"1.Vue3简介\"></a>1.Vue3简介</h2><ul>\n<li>2020年9月18日，Vue.js发布3.0版本，代号：One Piece（海贼王）</li>\n<li>耗时2年多、<a href=\"https://github.com/vuejs/vue-next/graphs/commit-activity\">2600+次提交</a>、<a href=\"https://github.com/vuejs/rfcs/tree/master/active-rfcs\">30+个RFC</a>、<a href=\"https://github.com/vuejs/vue-next/pulls?q=is%3Apr+is%3Amerged+-author%3Aapp%2Fdependabot-preview+\">600+次PR</a>、<a href=\"https://github.com/vuejs/vue-next/graphs/contributors\">99位贡献者</a> </li>\n<li>github上的tags地址：<a href=\"https://github.com/vuejs/vue-next/releases/tag/v3.0.0\">https://github.com/vuejs/vue-next/releases/tag/v3.0.0</a></li>\n</ul>\n<h2 id=\"2-Vue3带来了什么\"><a href=\"#2-Vue3带来了什么\" class=\"headerlink\" title=\"2.Vue3带来了什么\"></a>2.Vue3带来了什么</h2><h3 id=\"1-性能的提升\"><a href=\"#1-性能的提升\" class=\"headerlink\" title=\"1.性能的提升\"></a>1.性能的提升</h3><ul>\n<li><p>打包大小减少41%</p>\n</li>\n<li><p>初次渲染快55%, 更新渲染快133%</p>\n</li>\n<li><p>内存减少54%</p>\n<p>……</p>\n</li>\n</ul>\n<h3 id=\"2-源码的升级\"><a href=\"#2-源码的升级\" class=\"headerlink\" title=\"2.源码的升级\"></a>2.源码的升级</h3><ul>\n<li><p>使用Proxy代替defineProperty实现响应式</p>\n</li>\n<li><p>重写虚拟DOM的实现和Tree-Shaking</p>\n<p>……</p>\n</li>\n</ul>\n<h3 id=\"3-拥抱TypeScript\"><a href=\"#3-拥抱TypeScript\" class=\"headerlink\" title=\"3.拥抱TypeScript\"></a>3.拥抱TypeScript</h3><ul>\n<li>Vue3可以更好的支持TypeScript</li>\n</ul>\n<h3 id=\"4-新的特性\"><a href=\"#4-新的特性\" class=\"headerlink\" title=\"4.新的特性\"></a>4.新的特性</h3><ol>\n<li><p>Composition API（组合API）</p>\n<ul>\n<li>setup配置</li>\n<li>ref与reactive</li>\n<li>watch与watchEffect</li>\n<li>provide与inject</li>\n<li>……</li>\n</ul>\n</li>\n<li>新的内置组件<ul>\n<li>Fragment </li>\n<li>Teleport</li>\n<li>Suspense</li>\n</ul>\n</li>\n<li><p>其他改变</p>\n<ul>\n<li>新的生命周期钩子</li>\n<li>data 选项应始终被声明为一个函数</li>\n<li>移除keyCode支持作为 v-on 的修饰符</li>\n<li>……</li>\n</ul>\n</li>\n</ol>\n<h1 id=\"一、创建Vue3-0工程\"><a href=\"#一、创建Vue3-0工程\" class=\"headerlink\" title=\"一、创建Vue3.0工程\"></a>一、创建Vue3.0工程</h1><h2 id=\"1-使用-vue-cli-创建\"><a href=\"#1-使用-vue-cli-创建\" class=\"headerlink\" title=\"1.使用 vue-cli 创建\"></a>1.使用 vue-cli 创建</h2><p>官方文档：<a href=\"https://cli.vuejs.org/zh/guide/creating-a-project.html#vue-create\">https://cli.vuejs.org/zh/guide/creating-a-project.html#vue-create</a></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">## 查看@vue/cli版本，确保@vue/cli版本在4.5.0以上</span></span><br><span class=\"line\">vue --version</span><br><span class=\"line\"><span class=\"comment\">## 安装或者升级你的@vue/cli</span></span><br><span class=\"line\">npm install -g @vue/cli</span><br><span class=\"line\"><span class=\"comment\">## 创建</span></span><br><span class=\"line\">vue create vue_test</span><br><span class=\"line\"><span class=\"comment\">## 启动</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> vue_test</span><br><span class=\"line\">npm run serve</span><br></pre></td></tr></table></figure>\n<h2 id=\"2-使用-vite-创建\"><a href=\"#2-使用-vite-创建\" class=\"headerlink\" title=\"2.使用 vite 创建\"></a>2.使用 vite 创建</h2><p>官方文档：<a href=\"https://v3.cn.vuejs.org/guide/installation.html#vite\">https://v3.cn.vuejs.org/guide/installation.html#vite</a></p>\n<p>vite官网：<a href=\"https://vitejs.cn\">https://vitejs.cn</a></p>\n<ul>\n<li>什么是vite？—— 新一代前端构建工具。</li>\n<li>优势如下：<ul>\n<li>开发环境中，无需打包操作，可快速的冷启动。</li>\n<li>轻量快速的热重载（HMR）。</li>\n<li>真正的按需编译，不再等待整个应用编译完成。</li>\n</ul>\n</li>\n<li>传统构建 与 vite构建对比图</li>\n</ul>\n<p><img src=\"https://cn.vitejs.dev/assets/bundler.37740380.png\" style=\"width:500px;height:280px;float:left\" /><img src=\"https://cn.vitejs.dev/assets/esm.3070012d.png\" style=\"width:480px;height:280px\" /></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">## 创建工程</span></span><br><span class=\"line\">npm init vite-app &lt;project-name&gt;</span><br><span class=\"line\"><span class=\"comment\">## 进入工程目录</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> &lt;project-name&gt;</span><br><span class=\"line\"><span class=\"comment\">## 安装依赖</span></span><br><span class=\"line\">npm install</span><br><span class=\"line\"><span class=\"comment\">## 运行</span></span><br><span class=\"line\">npm run dev</span><br></pre></td></tr></table></figure>\n<h1 id=\"二、常用-Composition-API\"><a href=\"#二、常用-Composition-API\" class=\"headerlink\" title=\"二、常用 Composition API\"></a>二、常用 Composition API</h1><p>官方文档: <a href=\"https://v3.cn.vuejs.org/guide/composition-api-introduction.html\">https://v3.cn.vuejs.org/guide/composition-api-introduction.html</a></p>\n<h2 id=\"1-拉开序幕的setup\"><a href=\"#1-拉开序幕的setup\" class=\"headerlink\" title=\"1.拉开序幕的setup\"></a>1.拉开序幕的setup</h2><ol>\n<li><p>理解：Vue3.0中一个新的配置项，值为一个函数。</p>\n</li>\n<li><p>setup是所有<strong style=\"color:#DD5145\">Composition API（组合API）</strong><i style=\"color:gray;font-weight:bold\">“ 表演的舞台 ”</i>。</p>\n</li>\n<li><p>组件中所用到的：数据、方法等等，均要配置在setup中。</p>\n</li>\n<li><p>setup函数的两种返回值：</p>\n<ol>\n<li>若返回一个对象，则对象中的属性、方法, 在模板中均可以直接使用。（重点关注！）</li>\n<li><span style=\"color:#aad\">若返回一个渲染函数：则可以自定义渲染内容。（了解）</span></li>\n</ol>\n</li>\n<li><p>注意点：</p>\n<ol>\n<li>尽量不要与Vue2.x配置混用<ul>\n<li>Vue2.x配置（data、methos、computed…）中<strong style=\"color:#DD5145\">可以访问到</strong>setup中的属性、方法。</li>\n<li>但在setup中<strong style=\"color:#DD5145\">不能访问到</strong>Vue2.x配置（data、methos、computed…）。</li>\n<li>如果有重名, setup优先。</li>\n</ul>\n</li>\n<li>setup不能是一个async函数，因为返回值不再是return的对象, 而是promise, 模板看不到return对象中的属性。（后期也可以返回一个Promise实例，但需要Suspense和异步组件的配合）</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>一个人的信息<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>姓名：&#123;&#123;name&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>年龄：&#123;&#123;age&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>性别：&#123;&#123;sex&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>a的值是：&#123;&#123;a&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;sayHello&quot;</span>&gt;</span>说话(Vue3所配置的——sayHello)<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t&lt;br&gt;</span><br><span class=\"line\">\t&lt;br&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;sayWelcome&quot;</span>&gt;</span>说话(Vue2所配置的——sayWelcome)<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t&lt;br&gt;</span><br><span class=\"line\">\t&lt;br&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;test1&quot;</span>&gt;</span>测试一下在Vue2的配置中去读取Vue3中的数据、方法<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t&lt;br&gt;</span><br><span class=\"line\">\t&lt;br&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;test2&quot;</span>&gt;</span>测试一下在Vue3的setup配置中去读取Vue2中的数据、方法<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"comment\">// import &#123;h&#125; from &#x27;vue&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">name</span>: <span class=\"string\">&#x27;App&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">data</span>(<span class=\"params\"></span>)</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">sex</span>:<span class=\"string\">&#x27;男&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">a</span>:<span class=\"number\">100</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">methods</span>: &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"function\"><span class=\"title\">sayWelcome</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\talert(<span class=\"string\">&#x27;欢迎来到尚硅谷学习&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"function\"><span class=\"title\">test1</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"built_in\">this</span>.sex)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"built_in\">this</span>.name)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"built_in\">this</span>.age)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"built_in\">this</span>.sayHello)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"comment\">//此处只是测试一下setup，暂时不考虑响应式的问题。</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"keyword\">async</span> <span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> name = <span class=\"string\">&#x27;张三&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> age = <span class=\"number\">18</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> a = <span class=\"number\">200</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//方法</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">sayHello</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\talert(<span class=\"string\">`我叫<span class=\"subst\">$&#123;name&#125;</span>，我<span class=\"subst\">$&#123;age&#125;</span>岁了，你好啊！`</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">test2</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(name)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(age)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(sayHello)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"built_in\">this</span>.sex)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"built_in\">this</span>.sayWelcome)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个对象（常用）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tname,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tage,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tsayHello,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\ttest2,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\ta</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个函数（渲染函数）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// return ()=&gt; h(&#x27;h1&#x27;,&#x27;尚硅谷&#x27;)</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<h2 id=\"2-ref函数\"><a href=\"#2-ref函数\" class=\"headerlink\" title=\"2.ref函数\"></a>2.ref函数</h2><ul>\n<li><p>作用: 定义一个响应式的数据</p>\n</li>\n<li><p>语法: <code>const xxx = ref(initValue)</code> </p>\n<ul>\n<li>创建一个包含响应式数据的<strong style=\"color:#DD5145\">引用对象（reference对象，简称ref对象）</strong>。</li>\n<li>JS中操作数据： <code>xxx.value</code></li>\n<li>模板中读取数据: 不需要.value，直接：<code>&lt;div&gt;&#123;&#123;xxx&#125;&#125;&lt;/div&gt;</code></li>\n</ul>\n</li>\n<li><p>备注：</p>\n<ul>\n<li>接收的数据可以是：基本类型、也可以是对象类型。</li>\n<li>基本类型的数据：响应式依然是靠<code>Object.defineProperty()</code>的<code>get</code>与<code>set</code>完成的。</li>\n<li>对象类型的数据：内部 <i style=\"color:gray;font-weight:bold\">“ 求助 ”</i> 了Vue3.0中的一个新函数—— <code>reactive</code>函数。</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>一个人的信息<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>姓名：&#123;&#123;name&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>年龄：&#123;&#123;age&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>工作种类：&#123;&#123;job.type&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>工作薪水：&#123;&#123;job.salary&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;changeInfo&quot;</span>&gt;</span>修改人的信息<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">import</span> &#123;ref&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">name</span>: <span class=\"string\">&#x27;App&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> name = ref(<span class=\"string\">&#x27;张三&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> age = ref(<span class=\"number\">18</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> job = ref(&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">type</span>:<span class=\"string\">&#x27;前端工程师&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">salary</span>:<span class=\"string\">&#x27;30K&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//方法</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">changeInfo</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"comment\">// name.value = &#x27;李四&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"comment\">// age.value = 48</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(job.value)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"comment\">// job.value.type = &#x27;UI设计师&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"comment\">// job.value.salary = &#x27;60K&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"comment\">// console.log(name,age)</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个对象（常用）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tname,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tage,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tjob,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tchangeInfo</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h2 id=\"3-reactive函数\"><a href=\"#3-reactive函数\" class=\"headerlink\" title=\"3.reactive函数\"></a>3.reactive函数</h2><ul>\n<li>作用: 定义一个<strong style=\"color:#DD5145\">对象类型</strong>的响应式数据（基本类型不要用它，要用<code>ref</code>函数）</li>\n<li>语法：<code>const 代理对象= reactive(源对象)</code>接收一个对象（或数组），返回一个<strong style=\"color:#DD5145\">代理对象（Proxy的实例对象，简称proxy对象）</strong></li>\n<li>reactive定义的响应式数据是“深层次的”。</li>\n<li>内部基于 ES6 的 Proxy 实现，通过代理对象操作源对象内部数据进行操作。</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>一个人的信息<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>姓名：&#123;&#123;person.name&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>年龄：&#123;&#123;person.age&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>工作种类：&#123;&#123;person.job.type&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>工作薪水：&#123;&#123;person.job.salary&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>爱好：&#123;&#123;person.hobby&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>测试的数据c：&#123;&#123;person.job.a.b.c&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;changeInfo&quot;</span>&gt;</span>修改人的信息<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">import</span> &#123;reactive&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">name</span>: <span class=\"string\">&#x27;App&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> person = reactive(&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">name</span>:<span class=\"string\">&#x27;张三&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">age</span>:<span class=\"number\">18</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">job</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t<span class=\"attr\">type</span>:<span class=\"string\">&#x27;前端工程师&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t<span class=\"attr\">salary</span>:<span class=\"string\">&#x27;30K&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t<span class=\"attr\">a</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t\t<span class=\"attr\">b</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t\t\t<span class=\"attr\">c</span>:<span class=\"number\">666</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">hobby</span>:[<span class=\"string\">&#x27;抽烟&#x27;</span>,<span class=\"string\">&#x27;喝酒&#x27;</span>,<span class=\"string\">&#x27;烫头&#x27;</span>]</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//方法</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">changeInfo</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson.name = <span class=\"string\">&#x27;李四&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson.age = <span class=\"number\">48</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson.job.type = <span class=\"string\">&#x27;UI设计师&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson.job.salary = <span class=\"string\">&#x27;60K&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson.job.a.b.c = <span class=\"number\">999</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson.hobby[<span class=\"number\">0</span>] = <span class=\"string\">&#x27;学习&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个对象（常用）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tchangeInfo</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n<h2 id=\"4-Vue3-0中的响应式原理\"><a href=\"#4-Vue3-0中的响应式原理\" class=\"headerlink\" title=\"4.Vue3.0中的响应式原理\"></a>4.Vue3.0中的响应式原理</h2><h3 id=\"vue2-x的响应式\"><a href=\"#vue2-x的响应式\" class=\"headerlink\" title=\"vue2.x的响应式\"></a>vue2.x的响应式</h3><ul>\n<li><p>实现原理：</p>\n<ul>\n<li><p>对象类型：通过<code>Object.defineProperty()</code>对属性的读取、修改进行拦截（数据劫持）。</p>\n</li>\n<li><p>数组类型：通过重写更新数组的一系列方法来实现拦截。（对数组的变更方法进行了包裹）。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">Object</span>.defineProperty(data, <span class=\"string\">&#x27;count&#x27;</span>, &#123;</span><br><span class=\"line\">    get () &#123;&#125;, </span><br><span class=\"line\">    set () &#123;&#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li><p>存在问题：</p>\n<ul>\n<li>新增属性、删除属性, 界面不会更新。</li>\n<li>直接通过下标修改数组, 界面不会自动更新。</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"Vue3-0的响应式\"><a href=\"#Vue3-0的响应式\" class=\"headerlink\" title=\"Vue3.0的响应式\"></a>Vue3.0的响应式</h3><ul>\n<li><p>实现原理: </p>\n<ul>\n<li><p>通过Proxy（代理）:  拦截对象中任意属性的变化, 包括：属性值的读写、属性的添加、属性的删除等。</p>\n</li>\n<li><p>通过Reflect（反射）:  对源对象的属性进行操作。</p>\n</li>\n<li><p>MDN文档中描述的Proxy与Reflect：</p>\n<ul>\n<li><p>Proxy：<a href=\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy\">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy</a></p>\n</li>\n<li><p>Reflect：<a href=\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Reflect\">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Reflect</a></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"built_in\">Proxy</span>(data, &#123;</span><br><span class=\"line\">\t<span class=\"comment\">// 拦截读取属性值</span></span><br><span class=\"line\">    get (target, prop) &#123;</span><br><span class=\"line\">    \t<span class=\"keyword\">return</span> <span class=\"built_in\">Reflect</span>.get(target, prop)</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"comment\">// 拦截设置属性值或添加新属性</span></span><br><span class=\"line\">    set (target, prop, value) &#123;</span><br><span class=\"line\">    \t<span class=\"keyword\">return</span> <span class=\"built_in\">Reflect</span>.set(target, prop, value)</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"comment\">// 拦截删除属性</span></span><br><span class=\"line\">    deleteProperty (target, prop) &#123;</span><br><span class=\"line\">    \t<span class=\"keyword\">return</span> <span class=\"built_in\">Reflect</span>.deleteProperty(target, prop)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">proxy.name = <span class=\"string\">&#x27;tom&#x27;</span>   </span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>代码：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"meta-keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Document<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text/javascript&quot;</span> &gt;</span><span class=\"javascript\"></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//源数据</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"keyword\">let</span> person = &#123;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t<span class=\"attr\">name</span>:<span class=\"string\">&#x27;张三&#x27;</span>,</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t<span class=\"attr\">age</span>:<span class=\"number\">18</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t&#125;</span></span><br><span class=\"line\"><span class=\"javascript\"></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//模拟Vue2中实现响应式</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//#region </span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">/* let p = &#123;&#125;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\tObject.defineProperty(p,&#x27;name&#x27;,&#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\tconfigurable:true,</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\tget()&#123; //有人读取name时调用</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\treturn person.name</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\tset(value)&#123; //有人修改name时调用</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\tconsole.log(&#x27;有人修改了name属性，我发现了，我要去更新界面！&#x27;)</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\tperson.name = value</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\tObject.defineProperty(p,&#x27;age&#x27;,&#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\tget()&#123; //有人读取age时调用</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\treturn person.age</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\tset(value)&#123; //有人修改age时调用</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\tconsole.log(&#x27;有人修改了age属性，我发现了，我要去更新界面！&#x27;)</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\tperson.age = value</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t&#125;) */</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//#endregion</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//模拟Vue3中实现响应式</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//#region </span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"keyword\">const</span> p = <span class=\"keyword\">new</span> <span class=\"built_in\">Proxy</span>(person,&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t<span class=\"comment\">//有人读取p的某个属性时调用</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t<span class=\"function\"><span class=\"title\">get</span>(<span class=\"params\">target,propName</span>)</span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">`有人读取了p身上的<span class=\"subst\">$&#123;propName&#125;</span>属性`</span>)</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t\t<span class=\"keyword\">return</span> <span class=\"built_in\">Reflect</span>.get(target,propName)</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t&#125;,</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t<span class=\"comment\">//有人修改p的某个属性、或给p追加某个属性时调用</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t<span class=\"function\"><span class=\"title\">set</span>(<span class=\"params\">target,propName,value</span>)</span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">`有人修改了p身上的<span class=\"subst\">$&#123;propName&#125;</span>属性，我要去更新界面了！`</span>)</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t\t<span class=\"built_in\">Reflect</span>.set(target,propName,value)</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t&#125;,</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t<span class=\"comment\">//有人删除p的某个属性时调用</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t<span class=\"function\"><span class=\"title\">deleteProperty</span>(<span class=\"params\">target,propName</span>)</span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">`有人删除了p身上的<span class=\"subst\">$&#123;propName&#125;</span>属性，我要去更新界面了！`</span>)</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t\t<span class=\"keyword\">return</span> <span class=\"built_in\">Reflect</span>.deleteProperty(target,propName)</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t\t&#125;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t&#125;)</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//#endregion</span></span></span><br><span class=\"line\"><span class=\"javascript\"></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"keyword\">let</span> obj = &#123;<span class=\"attr\">a</span>:<span class=\"number\">1</span>,<span class=\"attr\">b</span>:<span class=\"number\">2</span>&#125;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//通过Object.defineProperty去操作</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//#region </span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">/* try &#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\tObject.defineProperty(obj,&#x27;c&#x27;,&#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\tget()&#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\t\treturn 3</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\tObject.defineProperty(obj,&#x27;c&#x27;,&#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\tget()&#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\t\treturn 4</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t&#125; catch (error) &#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\tconsole.log(error)</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t&#125; */</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//#endregion</span></span></span><br><span class=\"line\"><span class=\"javascript\"></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//通过Reflect.defineProperty去操作</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//#region </span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">/* const x1 = Reflect.defineProperty(obj,&#x27;c&#x27;,&#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\tget()&#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\treturn 3</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\tconsole.log(x1)</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\tconst x2 = Reflect.defineProperty(obj,&#x27;c&#x27;,&#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\tget()&#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t\treturn 4</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t&#125;) </span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\tif(x2)&#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\tconsole.log(&#x27;某某某操作成功了！&#x27;)</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t&#125;else&#123;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t\tconsole.log(&#x27;某某某操作失败了！&#x27;)</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\">\t\t\t&#125; */</span></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">//#endregion</span></span></span><br><span class=\"line\"><span class=\"javascript\"></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t\t<span class=\"comment\">// console.log(&#x27;@@@&#x27;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"></span></span><br><span class=\"line\"><span class=\"javascript\">\t\t</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"5-reactive对比ref\"><a href=\"#5-reactive对比ref\" class=\"headerlink\" title=\"5.reactive对比ref\"></a>5.reactive对比ref</h2><ul>\n<li>从定义数据角度对比：<ul>\n<li>ref用来定义：<strong style=\"color:#DD5145\">基本类型数据</strong>。</li>\n<li>reactive用来定义：<strong style=\"color:#DD5145\">对象（或数组）类型数据</strong>。</li>\n<li>备注：ref也可以用来定义<strong style=\"color:#DD5145\">对象（或数组）类型数据</strong>, 它内部会自动通过<code>reactive</code>转为<strong style=\"color:#DD5145\">代理对象</strong>。</li>\n</ul>\n</li>\n<li>从原理角度对比：<ul>\n<li>ref通过<code>Object.defineProperty()</code>的<code>get</code>与<code>set</code>来实现响应式（数据劫持）。</li>\n<li>reactive通过使用<strong style=\"color:#DD5145\">Proxy</strong>来实现响应式（数据劫持）, 并通过<strong style=\"color:#DD5145\">Reflect</strong>操作<strong style=\"color:orange\">源对象</strong>内部的数据。</li>\n</ul>\n</li>\n<li>从使用角度对比：<ul>\n<li>ref定义的数据：操作数据<strong style=\"color:#DD5145\">需要</strong><code>.value</code>，读取数据时模板中直接读取<strong style=\"color:#DD5145\">不需要</strong><code>.value</code>。</li>\n<li>reactive定义的数据：操作数据与读取数据：<strong style=\"color:#DD5145\">均不需要</strong><code>.value</code>。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"6-setup的两个注意点\"><a href=\"#6-setup的两个注意点\" class=\"headerlink\" title=\"6.setup的两个注意点\"></a>6.setup的两个注意点</h2><ul>\n<li><p>setup执行的时机</p>\n<ul>\n<li>在beforeCreate之前执行一次，this是undefined。</li>\n</ul>\n</li>\n<li><p>setup的参数</p>\n<ul>\n<li>props：值为对象，包含：组件外部传递过来，且组件内部声明接收了的属性。</li>\n<li>context：上下文对象<ul>\n<li>attrs: 值为对象，包含：组件外部传递过来，但没有在props配置中声明的属性, 相当于 <code>this.$attrs</code>。</li>\n<li>slots: 收到的插槽内容, 相当于 <code>this.$slots</code>。</li>\n<li>emit: 分发自定义事件的函数, 相当于 <code>this.$emit</code>。</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>代码：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>一个人的信息<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>姓名：&#123;&#123;person.name&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>年龄：&#123;&#123;person.age&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;test&quot;</span>&gt;</span>测试触发一下Demo组件的Hello事件<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">import</span> &#123;reactive&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">name</span>: <span class=\"string\">&#x27;Demo&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">props</span>:[<span class=\"string\">&#x27;msg&#x27;</span>,<span class=\"string\">&#x27;school&#x27;</span>],</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">emits</span>:[<span class=\"string\">&#x27;hello&#x27;</span>],</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\">props,context</span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// console.log(&#x27;---setup---&#x27;,props)</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// console.log(&#x27;---setup---&#x27;,context)</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// console.log(&#x27;---setup---&#x27;,context.attrs) //相当与Vue2中的$attrs</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// console.log(&#x27;---setup---&#x27;,context.emit) //触发自定义事件的。</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---setup---&#x27;</span>,context.slots) <span class=\"comment\">//插槽</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> person = reactive(&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">name</span>:<span class=\"string\">&#x27;张三&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">age</span>:<span class=\"number\">18</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//方法</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">test</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tcontext.emit(<span class=\"string\">&#x27;hello&#x27;</span>,<span class=\"number\">666</span>)   <span class=\"comment\">//注意写法</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个对象（常用）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\ttest</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n<h2 id=\"7-计算属性与监视\"><a href=\"#7-计算属性与监视\" class=\"headerlink\" title=\"7.计算属性与监视\"></a>7.计算属性与监视</h2><h3 id=\"1-computed函数\"><a href=\"#1-computed函数\" class=\"headerlink\" title=\"1.computed函数\"></a>1.computed函数</h3><ul>\n<li><p>与Vue2.x中computed配置功能一致</p>\n</li>\n<li><p>写法</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123;computed&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">\t<span class=\"comment\">//计算属性——简写</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> fullName = computed(<span class=\"function\">()=&gt;</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> person.firstName + <span class=\"string\">&#x27;-&#x27;</span> + person.lastName</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    <span class=\"comment\">//计算属性——完整</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> fullName = computed(&#123;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"title\">get</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> person.firstName + <span class=\"string\">&#x27;-&#x27;</span> + person.lastName</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"function\"><span class=\"title\">set</span>(<span class=\"params\">value</span>)</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">const</span> nameArr = value.split(<span class=\"string\">&#x27;-&#x27;</span>)</span><br><span class=\"line\">            person.firstName = nameArr[<span class=\"number\">0</span>]</span><br><span class=\"line\">            person.lastName = nameArr[<span class=\"number\">1</span>]</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h3 id=\"2-watch函数\"><a href=\"#2-watch函数\" class=\"headerlink\" title=\"2.watch函数\"></a>2.watch函数</h3><ul>\n<li><p>与Vue2.x中watch配置功能一致</p>\n</li>\n<li><p>两个小“坑”：</p>\n<ul>\n<li>监视reactive定义的响应式数据时：oldValue无法正确获取、强制开启了深度监视（deep配置失效）。</li>\n<li>监视reactive定义的响应式数据中某个属性时：deep配置有效。</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//情况一：监视ref定义的响应式数据</span></span><br><span class=\"line\">watch(sum,<span class=\"function\">(<span class=\"params\">newValue,oldValue</span>)=&gt;</span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;sum变化了&#x27;</span>,newValue,oldValue)</span><br><span class=\"line\">&#125;,&#123;<span class=\"attr\">immediate</span>:<span class=\"literal\">true</span>&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//情况二：监视多个ref定义的响应式数据</span></span><br><span class=\"line\">watch([sum,msg],<span class=\"function\">(<span class=\"params\">newValue,oldValue</span>)=&gt;</span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;sum或msg变化了&#x27;</span>,newValue,oldValue)</span><br><span class=\"line\">&#125;) </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* 情况三：监视reactive定义的响应式数据</span></span><br><span class=\"line\"><span class=\"comment\">\t\t\t若watch监视的是reactive定义的响应式数据，则无法正确获得oldValue！！</span></span><br><span class=\"line\"><span class=\"comment\">\t\t\t若watch监视的是reactive定义的响应式数据，则强制开启了深度监视 </span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\">watch(person,<span class=\"function\">(<span class=\"params\">newValue,oldValue</span>)=&gt;</span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;person变化了&#x27;</span>,newValue,oldValue)</span><br><span class=\"line\">&#125;,&#123;<span class=\"attr\">immediate</span>:<span class=\"literal\">true</span>,<span class=\"attr\">deep</span>:<span class=\"literal\">false</span>&#125;) <span class=\"comment\">//此处的deep配置不再奏效</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//情况四：监视reactive定义的响应式数据中的某个属性</span></span><br><span class=\"line\">watch(<span class=\"function\">()=&gt;</span>person.job,<span class=\"function\">(<span class=\"params\">newValue,oldValue</span>)=&gt;</span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;person的job变化了&#x27;</span>,newValue,oldValue)</span><br><span class=\"line\">&#125;,&#123;<span class=\"attr\">immediate</span>:<span class=\"literal\">true</span>,<span class=\"attr\">deep</span>:<span class=\"literal\">true</span>&#125;) </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//情况五：监视reactive定义的响应式数据中的某些属性</span></span><br><span class=\"line\">watch([<span class=\"function\">()=&gt;</span>person.job,<span class=\"function\">()=&gt;</span>person.name],<span class=\"function\">(<span class=\"params\">newValue,oldValue</span>)=&gt;</span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;person的job变化了&#x27;</span>,newValue,oldValue)</span><br><span class=\"line\">&#125;,&#123;<span class=\"attr\">immediate</span>:<span class=\"literal\">true</span>,<span class=\"attr\">deep</span>:<span class=\"literal\">true</span>&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//特殊情况</span></span><br><span class=\"line\">watch(<span class=\"function\">()=&gt;</span>person.job,<span class=\"function\">(<span class=\"params\">newValue,oldValue</span>)=&gt;</span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;person的job变化了&#x27;</span>,newValue,oldValue)</span><br><span class=\"line\">&#125;,&#123;<span class=\"attr\">deep</span>:<span class=\"literal\">true</span>&#125;) <span class=\"comment\">//此处由于监视的是reactive素定义的对象中的某个属性，所以deep配置有效</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>全部代码：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>当前求和为：&#123;&#123;sum&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;sum++&quot;</span>&gt;</span>点我+1<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t&lt;hr&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>当前的信息为：&#123;&#123;msg&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;msg+=&#x27;！&#x27;&quot;</span>&gt;</span>修改信息<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t&lt;hr&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>姓名：&#123;&#123;person.name&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>年龄：&#123;&#123;person.age&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>薪资：&#123;&#123;person.job.j1.salary&#125;&#125;K<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;person.name+=&#x27;~&#x27;&quot;</span>&gt;</span>修改姓名<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;person.age++&quot;</span>&gt;</span>增长年龄<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;person.job.j1.salary++&quot;</span>&gt;</span>涨薪<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">import</span> &#123;ref,reactive,watch&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">name</span>: <span class=\"string\">&#x27;Demo&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> sum = ref(<span class=\"number\">0</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> msg = ref(<span class=\"string\">&#x27;你好啊&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> person = reactive(&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">name</span>:<span class=\"string\">&#x27;张三&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">age</span>:<span class=\"number\">18</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">job</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t<span class=\"attr\">j1</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t\t<span class=\"attr\">salary</span>:<span class=\"number\">20</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//情况一：监视ref所定义的一个响应式数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">/* watch(sum,(newValue,oldValue)=&gt;&#123;</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tconsole.log(&#x27;sum变了&#x27;,newValue,oldValue)</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;,&#123;immediate:true&#125;) */</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//情况二：监视ref所定义的多个响应式数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">/* watch([sum,msg],(newValue,oldValue)=&gt;&#123;</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tconsole.log(&#x27;sum或msg变了&#x27;,newValue,oldValue)</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;,&#123;immediate:true&#125;) */</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">/* </span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t情况三：监视reactive所定义的一个响应式数据的全部属性</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t\t1.注意：此处无法正确的获取oldValue</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t\t2.注意：强制开启了深度监视（deep配置无效）</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t*/</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">/* watch(person,(newValue,oldValue)=&gt;&#123;</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tconsole.log(&#x27;person变化了&#x27;,newValue,oldValue)</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;,&#123;deep:false&#125;) //此处的deep配置无效 */</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//情况四：监视reactive所定义的一个响应式数据中的某个属性</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">/* watch(()=&gt;person.name,(newValue,oldValue)=&gt;&#123;</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tconsole.log(&#x27;person的name变化了&#x27;,newValue,oldValue)</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)  */</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//情况五：监视reactive所定义的一个响应式数据中的某些属性</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">/* watch([()=&gt;person.name,()=&gt;person.age],(newValue,oldValue)=&gt;&#123;</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tconsole.log(&#x27;person的name或age变化了&#x27;,newValue,oldValue)</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)  */</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//特殊情况</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">/* watch(()=&gt;person.job,(newValue,oldValue)=&gt;&#123;</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tconsole.log(&#x27;person的job变化了&#x27;,newValue,oldValue)</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;,&#123;deep:true&#125;) //此处由于监视的是reactive素定义的对象中的某个属性，所以deep配置有效 */</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个对象（常用）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tsum,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tmsg,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n<h3 id=\"3-watchEffect函数\"><a href=\"#3-watchEffect函数\" class=\"headerlink\" title=\"3.watchEffect函数\"></a>3.watchEffect函数</h3><ul>\n<li><p>watch的套路是：既要指明监视的属性，也要指明监视的回调。</p>\n</li>\n<li><p>watchEffect的套路是：不用指明监视哪个属性，监视的回调中用到哪个属性，那就监视哪个属性。</p>\n</li>\n<li><p>watchEffect有点像computed：</p>\n<ul>\n<li>但computed注重的计算出来的值（回调函数的返回值），所以必须要写返回值。</li>\n<li>而watchEffect更注重的是过程（回调函数的函数体），所以不用写返回值。</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//watchEffect所指定的回调中用到的数据只要发生变化，则直接重新执行回调。</span></span><br><span class=\"line\">watchEffect(<span class=\"function\">()=&gt;</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> x1 = sum.value</span><br><span class=\"line\">    <span class=\"keyword\">const</span> x2 = person.age</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;watchEffect配置的回调执行了&#x27;</span>)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>当前求和为：&#123;&#123;sum&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;sum++&quot;</span>&gt;</span>点我+1<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t&lt;hr&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>当前的信息为：&#123;&#123;msg&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;msg+=&#x27;！&#x27;&quot;</span>&gt;</span>修改信息<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t&lt;hr&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>姓名：&#123;&#123;person.name&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>年龄：&#123;&#123;person.age&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>薪资：&#123;&#123;person.job.j1.salary&#125;&#125;K<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;person.name+=&#x27;~&#x27;&quot;</span>&gt;</span>修改姓名<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;person.age++&quot;</span>&gt;</span>增长年龄<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;person.job.j1.salary++&quot;</span>&gt;</span>涨薪<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">import</span> &#123;ref,reactive,watch,watchEffect&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">name</span>: <span class=\"string\">&#x27;Demo&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> sum = ref(<span class=\"number\">0</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> msg = ref(<span class=\"string\">&#x27;你好啊&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> person = reactive(&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">name</span>:<span class=\"string\">&#x27;张三&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">age</span>:<span class=\"number\">18</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">job</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t<span class=\"attr\">j1</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t\t<span class=\"attr\">salary</span>:<span class=\"number\">20</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//监视</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">/* watch(sum,(newValue,oldValue)=&gt;&#123;</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tconsole.log(&#x27;sum的值变化了&#x27;,newValue,oldValue)</span></span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;,&#123;immediate:true&#125;) */</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\twatchEffect(<span class=\"function\">()=&gt;</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"keyword\">const</span> x1 = sum.value</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"keyword\">const</span> x2 = person.job.j1.salary</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;watchEffect所指定的回调执行了&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个对象（常用）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tsum,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tmsg,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n<h2 id=\"8-生命周期\"><a href=\"#8-生命周期\" class=\"headerlink\" title=\"8.生命周期\"></a>8.生命周期</h2><p>Vue2生命周期</p>\n<p><img src=\"https://cn.vuejs.org/images/lifecycle.png\" alt=\"\"></p>\n<p>Vue3生命周期</p>\n<p><img src=\"https://v3.cn.vuejs.org/images/lifecycle.svg\" alt=\"\"></p>\n<ul>\n<li>Vue3.0中可以继续使用Vue2.x中的生命周期钩子，但有有两个被更名：<ul>\n<li><code>beforeDestroy</code>改名为 <code>beforeUnmount</code></li>\n<li><code>destroyed</code>改名为 <code>unmounted</code></li>\n</ul>\n</li>\n<li>Vue3.0也提供了 Composition API 形式的生命周期钩子，与Vue2.x中钩子对应关系如下：<ul>\n<li><code>beforeCreate</code>===&gt;<code>setup()</code></li>\n<li><code>created</code>=======&gt;<code>setup()</code></li>\n<li><code>beforeMount</code> ===&gt;<code>onBeforeMount</code></li>\n<li><code>mounted</code>=======&gt;<code>onMounted</code></li>\n<li><code>beforeUpdate</code>===&gt;<code>onBeforeUpdate</code></li>\n<li><code>updated</code> =======&gt;<code>onUpdated</code></li>\n<li><code>beforeUnmount</code> ==&gt;<code>onBeforeUnmount</code></li>\n<li><code>unmounted</code> =====&gt;<code>onUnmounted</code></li>\n</ul>\n</li>\n</ul>\n<p>通过Composition API 形式的生命周期钩子函数优先级高于通过配置项的生命周期钩子</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>当前求和为：&#123;&#123;sum&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;sum++&quot;</span>&gt;</span>点我+1<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">import</span> &#123;ref,onBeforeMount,onMounted,onBeforeUpdate,onUpdated,onBeforeUnmount,onUnmounted&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">name</span>: <span class=\"string\">&#x27;Demo&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---setup---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> sum = ref(<span class=\"number\">0</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//通过组合式API的形式去使用生命周期钩子</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\tonBeforeMount(<span class=\"function\">()=&gt;</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---onBeforeMount---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\tonMounted(<span class=\"function\">()=&gt;</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---onMounted---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\tonBeforeUpdate(<span class=\"function\">()=&gt;</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---onBeforeUpdate---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\tonUpdated(<span class=\"function\">()=&gt;</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---onUpdated---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\tonBeforeUnmount(<span class=\"function\">()=&gt;</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---onBeforeUnmount---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\tonUnmounted(<span class=\"function\">()=&gt;</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---onUnmounted---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个对象（常用）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;sum&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"comment\">//通过配置项的形式使用生命周期钩子</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"comment\">//#region </span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">beforeCreate</span>(<span class=\"params\"></span>)</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---beforeCreate---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">created</span>(<span class=\"params\"></span>)</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---created---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">beforeMount</span>(<span class=\"params\"></span>)</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---beforeMount---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">mounted</span>(<span class=\"params\"></span>)</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---mounted---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">beforeUpdate</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---beforeUpdate---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">updated</span>(<span class=\"params\"></span>)</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---updated---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">beforeUnmount</span>(<span class=\"params\"></span>)</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---beforeUnmount---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">unmounted</span>(<span class=\"params\"></span>)</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;---unmounted---&#x27;</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"comment\">//#endregion</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n<h2 id=\"9-自定义hook函数\"><a href=\"#9-自定义hook函数\" class=\"headerlink\" title=\"9.自定义hook函数\"></a>9.自定义hook函数</h2><ul>\n<li>什么是hook？—— 本质是一个函数，把setup函数中使用的Composition API进行了封装。</li>\n<li>类似于vue2.x中的mixin。</li>\n<li>自定义hook的优势: 复用代码, 让setup中的逻辑更清楚易懂。</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>当前求和为：&#123;&#123;sum&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;sum++&quot;</span>&gt;</span>点我+1<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t&lt;hr&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>当前点击时鼠标的坐标为：x：&#123;&#123;point.x&#125;&#125;，y：&#123;&#123;point.y&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">import</span> &#123;ref&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">import</span> usePoint <span class=\"keyword\">from</span> <span class=\"string\">&#x27;../hooks/usePoint&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">name</span>: <span class=\"string\">&#x27;Demo&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> sum = ref(<span class=\"number\">0</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> point = usePoint()</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个对象（常用）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;sum,point&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n<p>hooks</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123;reactive,onMounted,onBeforeUnmount&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//实现鼠标“打点”相关的数据</span></span><br><span class=\"line\">\t<span class=\"keyword\">let</span> point = reactive(&#123;</span><br><span class=\"line\">\t\t<span class=\"attr\">x</span>:<span class=\"number\">0</span>,</span><br><span class=\"line\">\t\t<span class=\"attr\">y</span>:<span class=\"number\">0</span></span><br><span class=\"line\">\t&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//实现鼠标“打点”相关的方法</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">savePoint</span>(<span class=\"params\">event</span>)</span>&#123;</span><br><span class=\"line\">\t\tpoint.x = event.pageX</span><br><span class=\"line\">\t\tpoint.y = event.pageY</span><br><span class=\"line\">\t\t<span class=\"built_in\">console</span>.log(event.pageX,event.pageY)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//实现鼠标“打点”相关的生命周期钩子</span></span><br><span class=\"line\">\tonMounted(<span class=\"function\">()=&gt;</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">window</span>.addEventListener(<span class=\"string\">&#x27;click&#x27;</span>,savePoint)</span><br><span class=\"line\">\t&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">\tonBeforeUnmount(<span class=\"function\">()=&gt;</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">window</span>.removeEventListener(<span class=\"string\">&#x27;click&#x27;</span>,savePoint)</span><br><span class=\"line\">\t&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> point</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://qny.aqingya.cn/img/20220118180338.png\" alt=\"\"></p>\n<p><img src=\"https://qny.aqingya.cn/img/20220118180458.png\" alt=\"\"></p>\n<h2 id=\"10-toRef\"><a href=\"#10-toRef\" class=\"headerlink\" title=\"10.toRef\"></a>10.toRef</h2><ul>\n<li>作用：创建一个 ref 对象，其value值指向另一个对象中的某个属性。</li>\n<li>语法：<code>const name = toRef(person,&#39;name&#39;)</code></li>\n<li>应用:   要将响应式对象中的某个属性单独提供给外部使用时。</li>\n</ul>\n<ul>\n<li>扩展：<code>toRefs</code> 与<code>toRef</code>功能一致，但可以批量创建多个 ref 对象，语法：<code>toRefs(person)</code></li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>&#123;&#123;person&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>姓名：&#123;&#123;name&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>年龄：&#123;&#123;age&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>薪资：&#123;&#123;job.j1.salary&#125;&#125;K<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;name+=&#x27;~&#x27;&quot;</span>&gt;</span>修改姓名<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;age++&quot;</span>&gt;</span>增长年龄<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;job.j1.salary++&quot;</span>&gt;</span>涨薪<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">import</span> &#123;ref,reactive,toRef,toRefs&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">name</span>: <span class=\"string\">&#x27;Demo&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> person = reactive(&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">name</span>:<span class=\"string\">&#x27;张三&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">age</span>:<span class=\"number\">18</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">job</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t<span class=\"attr\">j1</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t\t<span class=\"attr\">salary</span>:<span class=\"number\">20</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// const name1 = person.name</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// console.log(&#x27;%%%&#x27;,name1)</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// const name2 = toRef(person,&#x27;name&#x27;)</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// console.log(&#x27;####&#x27;,name2)</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">const</span> x = toRefs(person)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;******&#x27;</span>,x)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个对象（常用）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"comment\">// name:toRef(person,&#x27;name&#x27;),</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"comment\">// age:toRef(person,&#x27;age&#x27;),</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"comment\">// salary:toRef(person.job.j1,&#x27;salary&#x27;),</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t...toRefs(person)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n<h1 id=\"三、其它-Composition-API\"><a href=\"#三、其它-Composition-API\" class=\"headerlink\" title=\"三、其它 Composition API\"></a>三、其它 Composition API</h1><h2 id=\"1-shallowReactive-与-shallowRef\"><a href=\"#1-shallowReactive-与-shallowRef\" class=\"headerlink\" title=\"1.shallowReactive 与 shallowRef\"></a>1.shallowReactive 与 shallowRef</h2><ul>\n<li>shallowReactive：只处理对象最外层属性的响应式（浅响应式）。</li>\n<li><p>shallowRef：只处理基本数据类型的响应式, 不进行对象的响应式处理。</p>\n</li>\n<li><p>什么时候使用?</p>\n<ul>\n<li>如果有一个对象数据，结构比较深, 但变化时只是外层属性变化 ===&gt; shallowReactive。</li>\n<li>如果有一个对象数据，后续功能不会修改该对象中的属性，而是生新的对象来替换 ===&gt; shallowRef。</li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>当前的x.y值是：&#123;&#123;x.y&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;x=&#123;y:888&#125;&quot;</span>&gt;</span>点我替换x<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;x.y++&quot;</span>&gt;</span>点我x.y++<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t&lt;hr&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>&#123;&#123;person&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>姓名：&#123;&#123;name&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>年龄：&#123;&#123;age&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>薪资：&#123;&#123;job.j1.salary&#125;&#125;K<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;name+=&#x27;~&#x27;&quot;</span>&gt;</span>修改姓名<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;age++&quot;</span>&gt;</span>增长年龄<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;job.j1.salary++&quot;</span>&gt;</span>涨薪<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">import</span> &#123;ref,reactive,toRef,toRefs,shallowReactive,shallowRef&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">name</span>: <span class=\"string\">&#x27;Demo&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// let person = shallowReactive(&#123; //只考虑第一层数据的响应式</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> person = reactive(&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">name</span>:<span class=\"string\">&#x27;张三&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">age</span>:<span class=\"number\">18</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">job</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t<span class=\"attr\">j1</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t\t<span class=\"attr\">salary</span>:<span class=\"number\">20</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> x = shallowRef(&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">y</span>:<span class=\"number\">0</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&#x27;******&#x27;</span>,x)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个对象（常用）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tx,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t...toRefs(person)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"2-readonly-与-shallowReadonly\"><a href=\"#2-readonly-与-shallowReadonly\" class=\"headerlink\" title=\"2.readonly 与 shallowReadonly\"></a>2.readonly 与 shallowReadonly</h2><ul>\n<li>readonly: 让一个响应式数据变为只读的（深只读）。</li>\n<li>shallowReadonly：让一个响应式数据变为只读的（浅只读）。</li>\n<li>应用场景: 1、不希望数据被修改时；2、有可能这个数据是别人给你的，别人不希望你修改这个数据；</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>当前求和为：&#123;&#123;sum&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;sum++&quot;</span>&gt;</span>点我++<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t&lt;hr&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>姓名：&#123;&#123;name&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>年龄：&#123;&#123;age&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>薪资：&#123;&#123;job.j1.salary&#125;&#125;K<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;name+=&#x27;~&#x27;&quot;</span>&gt;</span>修改姓名<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;age++&quot;</span>&gt;</span>增长年龄<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;job.j1.salary++&quot;</span>&gt;</span>涨薪<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">import</span> &#123;ref,reactive,toRefs,readonly,shallowReadonly&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">name</span>: <span class=\"string\">&#x27;Demo&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> sum = ref(<span class=\"number\">0</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> person = reactive(&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">name</span>:<span class=\"string\">&#x27;张三&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">age</span>:<span class=\"number\">18</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">job</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t<span class=\"attr\">j1</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t\t<span class=\"attr\">salary</span>:<span class=\"number\">20</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\tperson = readonly(person)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// person = shallowReadonly(person)</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// sum = readonly(sum)</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">// sum = shallowReadonly(sum)</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个对象（常用）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tsum,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t...toRefs(person)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n<h2 id=\"3-toRaw-与-markRaw\"><a href=\"#3-toRaw-与-markRaw\" class=\"headerlink\" title=\"3.toRaw 与 markRaw\"></a>3.toRaw 与 markRaw</h2><ul>\n<li>toRaw：(可以理解为还原)<ul>\n<li>作用：将一个由<code>reactive</code>生成的<strong style=\"color:orange\">响应式对象</strong>转为<strong style=\"color:orange\">普通对象</strong>。</li>\n<li>使用场景：用于读取响应式对象对应的普通对象，对这个普通对象的所有操作，不会引起页面更新。</li>\n</ul>\n</li>\n<li>markRaw：<ul>\n<li>作用：标记一个对象，使其永远不会再成为响应式对象。</li>\n<li>应用场景:<ol>\n<li>有些值不应被设置为响应式的，例如复杂的第三方类库等。</li>\n<li>当渲染具有不可变数据源的大列表时，跳过响应式转换可以提高性能。</li>\n</ol>\n</li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>当前求和为：&#123;&#123;sum&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;sum++&quot;</span>&gt;</span>点我++<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t&lt;hr&gt;</span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>姓名：&#123;&#123;name&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>年龄：&#123;&#123;age&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>薪资：&#123;&#123;job.j1.salary&#125;&#125;K<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">h3</span> <span class=\"attr\">v-show</span>=<span class=\"string\">&quot;person.car&quot;</span>&gt;</span>座驾信息：&#123;&#123;person.car&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;name+=&#x27;~&#x27;&quot;</span>&gt;</span>修改姓名<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;age++&quot;</span>&gt;</span>增长年龄<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;job.j1.salary++&quot;</span>&gt;</span>涨薪<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;showRawPerson&quot;</span>&gt;</span>输出最原始的person<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;addCar&quot;</span>&gt;</span>给人添加一台车<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;person.car.name+=&#x27;!&#x27;&quot;</span>&gt;</span>换车名<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">\t<span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;changePrice&quot;</span>&gt;</span>换价格<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span></span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">import</span> &#123;ref,reactive,toRefs,toRaw,markRaw&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t<span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"attr\">name</span>: <span class=\"string\">&#x27;Demo&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t<span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//数据</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> sum = ref(<span class=\"number\">0</span>)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">let</span> person = reactive(&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">name</span>:<span class=\"string\">&#x27;张三&#x27;</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">age</span>:<span class=\"number\">18</span>,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"attr\">job</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t<span class=\"attr\">j1</span>:&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t\t<span class=\"attr\">salary</span>:<span class=\"number\">20</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">showRawPerson</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"keyword\">const</span> p = toRaw(person)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tp.age++</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(p)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">addCar</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"keyword\">let</span> car = &#123;<span class=\"attr\">name</span>:<span class=\"string\">&#x27;奔驰&#x27;</span>,<span class=\"attr\">price</span>:<span class=\"number\">40</span>&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson.car = markRaw(car)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">changePrice</span>(<span class=\"params\"></span>)</span>&#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson.car.price++</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t<span class=\"built_in\">console</span>.log(person.car.price)</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"comment\">//返回一个对象（常用）</span></span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t<span class=\"keyword\">return</span> &#123;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tsum,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tperson,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\t...toRefs(person),</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tshowRawPerson,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\taddCar,</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t\tchangePrice</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\">\t&#125;</span></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"xml\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n<h2 id=\"4-customRef\"><a href=\"#4-customRef\" class=\"headerlink\" title=\"4.customRef\"></a>4.customRef</h2><ul>\n<li><p>作用：创建一个自定义的 ref，并对其依赖项跟踪和更新触发进行显式控制。</p>\n</li>\n<li><p>实现防抖效果：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t&lt;input type=&quot;text&quot; v-model=&quot;keyword&quot;&gt;</span><br><span class=\"line\">\t&lt;h3&gt;&#123;&#123;keyword&#125;&#125;&lt;/h3&gt;</span><br><span class=\"line\">&lt;/template&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\">\timport &#123;ref,customRef&#125; from &#x27;vue&#x27;</span><br><span class=\"line\">\texport default &#123;</span><br><span class=\"line\">\t\tname:&#x27;Demo&#x27;,</span><br><span class=\"line\">\t\tsetup()&#123;</span><br><span class=\"line\">\t\t\t// let keyword = ref(&#x27;hello&#x27;) //使用Vue准备好的内置ref</span><br><span class=\"line\">\t\t\t//自定义一个myRef</span><br><span class=\"line\">\t\t\tfunction myRef(value,delay)&#123;</span><br><span class=\"line\">\t\t\t\tlet timer</span><br><span class=\"line\">\t\t\t\t//通过customRef去实现自定义</span><br><span class=\"line\">\t\t\t\treturn customRef((track,trigger)=&gt;&#123;</span><br><span class=\"line\">\t\t\t\t\treturn&#123;</span><br><span class=\"line\">\t\t\t\t\t\tget()&#123;</span><br><span class=\"line\">\t\t\t\t\t\t\ttrack() //告诉Vue这个value值是需要被“追踪”的</span><br><span class=\"line\">\t\t\t\t\t\t\treturn value</span><br><span class=\"line\">\t\t\t\t\t\t&#125;,</span><br><span class=\"line\">\t\t\t\t\t\tset(newValue)&#123;</span><br><span class=\"line\">\t\t\t\t\t\t\tclearTimeout(timer)</span><br><span class=\"line\">\t\t\t\t\t\t\ttimer = setTimeout(()=&gt;&#123;</span><br><span class=\"line\">\t\t\t\t\t\t\t\tvalue = newValue</span><br><span class=\"line\">\t\t\t\t\t\t\t\ttrigger() //告诉Vue去更新界面</span><br><span class=\"line\">\t\t\t\t\t\t\t&#125;,delay)</span><br><span class=\"line\">\t\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t&#125;)</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\tlet keyword = myRef(&#x27;hello&#x27;,500) //使用程序员自定义的ref</span><br><span class=\"line\">\t\t\treturn &#123;</span><br><span class=\"line\">\t\t\t\tkeyword</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h2 id=\"5-provide-与-inject\"><a href=\"#5-provide-与-inject\" class=\"headerlink\" title=\"5.provide 与 inject\"></a>5.provide 与 inject</h2><p><img src=\"https://v3.cn.vuejs.org/images/components_provide.png\" style=\"width:300px\" /></p>\n<ul>\n<li><p>作用：实现<strong style=\"color:#DD5145\">祖与后代组件间</strong>通信</p>\n</li>\n<li><p>套路：父组件有一个 <code>provide</code> 选项来提供数据，后代组件有一个 <code>inject</code> 选项来开始使用这些数据</p>\n</li>\n<li><p>具体写法：</p>\n<ol>\n<li><p>祖组件中：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\"></span>)</span>&#123;\t......    <span class=\"keyword\">let</span> car = reactive(&#123;<span class=\"attr\">name</span>:<span class=\"string\">&#x27;奔驰&#x27;</span>,<span class=\"attr\">price</span>:<span class=\"string\">&#x27;40万&#x27;</span>&#125;)    provide(<span class=\"string\">&#x27;car&#x27;</span>,car)    ......&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>后代组件中：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"title\">setup</span>(<span class=\"params\">props,context</span>)</span>&#123;\t......    <span class=\"keyword\">const</span> car = inject(<span class=\"string\">&#x27;car&#x27;</span>)    <span class=\"keyword\">return</span> &#123;car&#125;\t......&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n</li>\n</ul>\n<h2 id=\"6-响应式数据的判断\"><a href=\"#6-响应式数据的判断\" class=\"headerlink\" title=\"6.响应式数据的判断\"></a>6.响应式数据的判断</h2><ul>\n<li>isRef: 检查一个值是否为一个 ref 对象</li>\n<li>isReactive: 检查一个对象是否是由 <code>reactive</code> 创建的响应式代理</li>\n<li>isReadonly: 检查一个对象是否是由 <code>readonly</code> 创建的只读代理</li>\n<li>isProxy: 检查一个对象是否是由 <code>reactive</code> 或者 <code>readonly</code> 方法创建的代理</li>\n</ul>\n<h1 id=\"四、Composition-API-的优势\"><a href=\"#四、Composition-API-的优势\" class=\"headerlink\" title=\"四、Composition API 的优势\"></a>四、Composition API 的优势</h1><h2 id=\"1-Options-API-存在的问题\"><a href=\"#1-Options-API-存在的问题\" class=\"headerlink\" title=\"1.Options API 存在的问题\"></a>1.Options API 存在的问题</h2><p>使用传统OptionsAPI中，新增或者修改一个需求，就需要分别在data，methods，computed里修改 。</p>\n<p><img src=\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f84e4e2c02424d9a99862ade0a2e4114~tplv-k3u1fbpfcp-watermark.image\" alt=\"\"></p>\n<p><img src=\"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e5ac7e20d1784887a826f6360768a368~tplv-k3u1fbpfcp-watermark.image\" alt=\"\"></p>\n<h2 id=\"2-Composition-API-的优势\"><a href=\"#2-Composition-API-的优势\" class=\"headerlink\" title=\"2.Composition API 的优势\"></a>2.Composition API 的优势</h2><p>我们可以更加优雅的组织我们的代码，函数。让相关功能的代码更加有序的组织在一起。</p>\n<p><img src=\"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6cc55165c0e34069a75fe36f8712eb80~tplv-k3u1fbpfcp-watermark.image\" alt=\"\"></p>\n<p><img src=\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bc0be8211fc54b6c941c036791ba4efe~tplv-k3u1fbpfcp-watermark.image\" alt=\"\"></p>\n<h1 id=\"五、新的组件\"><a href=\"#五、新的组件\" class=\"headerlink\" title=\"五、新的组件\"></a>五、新的组件</h1><h2 id=\"1-Fragment\"><a href=\"#1-Fragment\" class=\"headerlink\" title=\"1.Fragment\"></a>1.Fragment</h2><ul>\n<li>在Vue2中: 组件必须有一个根标签</li>\n<li>在Vue3中: 组件可以没有根标签, 内部会将多个标签包含在一个Fragment虚拟元素中</li>\n<li>好处: 减少标签层级, 减小内存占用</li>\n</ul>\n<h2 id=\"2-Teleport\"><a href=\"#2-Teleport\" class=\"headerlink\" title=\"2.Teleport\"></a>2.Teleport</h2><ul>\n<li><p>什么是Teleport？—— <code>Teleport</code> 是一种能够将我们的<strong style=\"color:#DD5145\">组件html结构</strong>移动到指定位置的技术。</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">template</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;isShow = true&quot;</span>&gt;</span>点我弹个窗<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">teleport</span> <span class=\"attr\">to</span>=<span class=\"string\">&quot;body&quot;</span>&gt;</span></span><br><span class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">v-if</span>=<span class=\"string\">&quot;isShow&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;mask&quot;</span>&gt;</span></span><br><span class=\"line\">\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;dialog&quot;</span>&gt;</span></span><br><span class=\"line\">\t\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">h3</span>&gt;</span>我是一个弹窗<span class=\"tag\">&lt;/<span class=\"name\">h3</span>&gt;</span></span><br><span class=\"line\">\t\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>一些内容<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span><br><span class=\"line\">\t\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>一些内容<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span><br><span class=\"line\">\t\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">h4</span>&gt;</span>一些内容<span class=\"tag\">&lt;/<span class=\"name\">h4</span>&gt;</span></span><br><span class=\"line\">\t\t\t\t\t<span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;isShow = false&quot;</span>&gt;</span>关闭弹窗<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\">\t\t\t\t<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">\t\t\t<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;/<span class=\"name\">teleport</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">template</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h2 id=\"3-Suspense\"><a href=\"#3-Suspense\" class=\"headerlink\" title=\"3.Suspense\"></a>3.Suspense</h2><ul>\n<li><p>等待异步组件时渲染一些额外内容，让应用有更好的用户体验</p>\n</li>\n<li><p>使用步骤：</p>\n<ul>\n<li><p>异步引入组件</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123;defineAsyncComponent&#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;vue&#x27;</span><span class=\"keyword\">const</span> Child = defineAsyncComponent(<span class=\"function\">()=&gt;</span><span class=\"keyword\">import</span>(<span class=\"string\">&#x27;./components/Child.vue&#x27;</span>))</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>使用<code>Suspense</code>包裹组件，并配置好<code>default</code> 与 <code>fallback</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;\t&lt;div class=&quot;app&quot;&gt;\t\t&lt;h3&gt;我是App组件&lt;/h3&gt;\t\t&lt;Suspense&gt;\t\t\t&lt;template v-slot:default&gt;\t\t\t\t&lt;Child/&gt;\t\t\t&lt;/template&gt;\t\t\t&lt;template v-slot:fallback&gt;\t\t\t\t&lt;h3&gt;加载中.....&lt;/h3&gt;\t\t\t&lt;/template&gt;\t\t&lt;/Suspense&gt;\t&lt;/div&gt;&lt;/template&gt;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"六、其他\"><a href=\"#六、其他\" class=\"headerlink\" title=\"六、其他\"></a>六、其他</h1><h2 id=\"1-全局API的转移\"><a href=\"#1-全局API的转移\" class=\"headerlink\" title=\"1.全局API的转移\"></a>1.全局API的转移</h2><ul>\n<li><p>Vue 2.x 有许多全局 API 和配置。</p>\n<ul>\n<li><p>例如：注册全局组件、注册全局指令等。</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//注册全局组件Vue.component(&#x27;MyButton&#x27;, &#123;  data: () =&gt; (&#123;    count: 0  &#125;),  template: &#x27;&lt;button @click=&quot;count++&quot;&gt;Clicked &#123;&#123; count &#125;&#125; times.&lt;/button&gt;&#x27;&#125;)//注册全局指令Vue.directive(&#x27;focus&#x27;, &#123;  inserted: el =&gt; el.focus()&#125;</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li><p>Vue3.0中对这些API做出了调整：</p>\n<ul>\n<li><p>将全局的API，即：<code>Vue.xxx</code>调整到应用实例（<code>app</code>）上</p>\n<p>| 2.x 全局 API（<code>Vue</code>） | 3.x 实例 API (<code>app</code>)                        |<br>| ————————————- | —————————————————————- |<br>| Vue.config.xxxx           | app.config.xxxx                             |<br>| Vue.config.productionTip  | <strong style=\"color:#DD5145\">移除</strong> |<br>| Vue.component             | app.component                               |<br>| Vue.directive             | app.directive                               |<br>| Vue.mixin                 | app.mixin                                   |<br>| Vue.use                   | app.use                                     |<br>| Vue.prototype             | app.config.globalProperties                 |</p>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"2-其他改变\"><a href=\"#2-其他改变\" class=\"headerlink\" title=\"2.其他改变\"></a>2.其他改变</h2><ul>\n<li><p>data选项应始终被声明为一个函数。</p>\n</li>\n<li><p>过度类名的更改：</p>\n<ul>\n<li><p>Vue2.x写法</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.v-enter</span>,<span class=\"selector-class\">.v-leave-to</span> &#123;  <span class=\"attribute\">opacity</span>: <span class=\"number\">0</span>;&#125;<span class=\"selector-class\">.v-leave</span>,<span class=\"selector-class\">.v-enter-to</span> &#123;  <span class=\"attribute\">opacity</span>: <span class=\"number\">1</span>;&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Vue3.x写法</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.v-enter-from</span>,<span class=\"selector-class\">.v-leave-to</span> &#123;  <span class=\"attribute\">opacity</span>: <span class=\"number\">0</span>;&#125;<span class=\"selector-class\">.v-leave-from</span>,<span class=\"selector-class\">.v-enter-to</span> &#123;  <span class=\"attribute\">opacity</span>: <span class=\"number\">1</span>;&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li><p><strong style=\"color:#DD5145\">移除</strong>keyCode作为 v-on 的修饰符，同时也不再支持<code>config.keyCodes</code> （自定义按键别名）</p>\n</li>\n<li><p><strong style=\"color:#DD5145\">移除</strong><code>v-on.native</code>修饰符</p>\n<ul>\n<li><p>父组件中绑定事件</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;my-component  v-on:close=&quot;handleComponentEvent&quot;  v-on:click=&quot;handleNativeClickEvent&quot;/&gt;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>子组件中声明自定义事件</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script&gt;  export default &#123;    emits: [&#x27;close&#x27;]  &#125;&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li><p><strong style=\"color:#DD5145\">移除</strong>过滤器（filter）</p>\n<blockquote>\n<p>过滤器虽然这看起来很方便，但它需要一个自定义语法，打破大括号内表达式是 “只是 JavaScript” 的假设，这不仅有学习成本，而且有实现成本！建议用方法调用或计算属性去替换过滤器。</p>\n</blockquote>\n</li>\n<li><p>……</p>\n</li>\n</ul>\n","categories":[{"name":"Vue3","path":"api/categories/Vue3.json"}],"tags":[{"name":"vue","path":"api/tags/vue.json"},{"name":"vue3","path":"api/tags/vue3.json"}]}