{"title":"AJAX 手动和自动将请求的JSON数据进行字符串转换","slug":"110","date":"2020-09-03T14:56:49.000Z","updated":"2020-09-03T15:16:38.000Z","comments":true,"path":"api/articles/110.json","excerpt":" [Figure] ","covers":["https://cdn.jsdelivr.net/gh/wuzhiguang1/bolgfile@1.8/photo/6qp5y6.png"],"content":"<p><img src=\"https://cdn.jsdelivr.net/gh/wuzhiguang1/bolgfile@1.8/photo/6qp5y6.png\" alt=\"\"></p>\n<span id=\"more\"></span>\n<p>我们请求后端的时候一般返回的是字符串，而我们需要的数据，因此我们在请求到JSON数据的时候需要对他们进行转换。</p>\n<h2 id=\"手动转换\"><a href=\"#手动转换\" class=\"headerlink\" title=\"手动转换\"></a>手动转换</h2><p>借助JSON的parse方法。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//发送请求</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> xhr = <span class=\"keyword\">new</span> XMLHttpRequest();</span><br><span class=\"line\"><span class=\"comment\">//初始化</span></span><br><span class=\"line\">xhr.open(<span class=\"string\">&#x27;GET&#x27;</span>, <span class=\"string\">&#x27;http://127.0.0.1:8000/json-server&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">//发送</span></span><br><span class=\"line\">xhr.send();</span><br><span class=\"line\"><span class=\"comment\">//事件绑定</span></span><br><span class=\"line\">xhr.onreadystatechange = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (xhr.readyState === <span class=\"number\">4</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (xhr.status &gt;= <span class=\"number\">200</span> &amp;&amp; xhr.status &lt; <span class=\"number\">300</span>) &#123;</span><br><span class=\"line\">      <span class=\"comment\">//</span></span><br><span class=\"line\">      <span class=\"comment\">// console.log(xhr.response);</span></span><br><span class=\"line\">      <span class=\"comment\">// result.innerHTML = xhr.response;</span></span><br><span class=\"line\">        </span><br><span class=\"line\">      <span class=\"comment\">// 1. 手动对数据转化</span></span><br><span class=\"line\">      <span class=\"keyword\">let</span> data = <span class=\"built_in\">JSON</span>.parse(xhr.response); <span class=\"comment\">//-----------------------------</span></span><br><span class=\"line\">      <span class=\"built_in\">console</span>.log(data);</span><br><span class=\"line\">      result.innerHTML = data.name; </span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><br></p>\n<h2 id=\"自动转换\"><a href=\"#自动转换\" class=\"headerlink\" title=\"自动转换\"></a>自动转换</h2><p>借助xhr对象上的一个属性来进行设置。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//发送请求</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> xhr = <span class=\"keyword\">new</span> XMLHttpRequest();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//设置响应体数据的类型</span></span><br><span class=\"line\"> xhr.responseType = <span class=\"string\">&#x27;json&#x27;</span>;   <span class=\"comment\">//----------------------------------------</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//初始化</span></span><br><span class=\"line\">xhr.open(<span class=\"string\">&#x27;GET&#x27;</span>, <span class=\"string\">&#x27;http://127.0.0.1:8000/json-server&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">//发送</span></span><br><span class=\"line\">xhr.send();</span><br><span class=\"line\"><span class=\"comment\">//事件绑定</span></span><br><span class=\"line\">xhr.onreadystatechange = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (xhr.readyState === <span class=\"number\">4</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (xhr.status &gt;= <span class=\"number\">200</span> &amp;&amp; xhr.status &lt; <span class=\"number\">300</span>) &#123;</span><br><span class=\"line\">      <span class=\"comment\">//</span></span><br><span class=\"line\">      <span class=\"comment\">// console.log(xhr.response);</span></span><br><span class=\"line\">      <span class=\"comment\">// result.innerHTML = xhr.response;</span></span><br><span class=\"line\">      <span class=\"comment\">// 1. 手动对数据转化</span></span><br><span class=\"line\">      <span class=\"comment\">//let data = JSON.parse(xhr.response);</span></span><br><span class=\"line\">      <span class=\"comment\">//console.log(data);</span></span><br><span class=\"line\">      <span class=\"comment\">//result.innerHTML = data.name;</span></span><br><span class=\"line\">        </span><br><span class=\"line\">      <span class=\"comment\">// // 2. 自动转换</span></span><br><span class=\"line\">       <span class=\"built_in\">console</span>.log(xhr.response);</span><br><span class=\"line\">       result.innerHTML = xhr.response.name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><br><br><br></p>\n","more":"<p>我们请求后端的时候一般返回的是字符串，而我们需要的数据，因此我们在请求到JSON数据的时候需要对他们进行转换。</p>\n<h2 id=\"手动转换\"><a href=\"#手动转换\" class=\"headerlink\" title=\"手动转换\"></a>手动转换</h2><p>借助JSON的parse方法。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//发送请求</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> xhr = <span class=\"keyword\">new</span> XMLHttpRequest();</span><br><span class=\"line\"><span class=\"comment\">//初始化</span></span><br><span class=\"line\">xhr.open(<span class=\"string\">&#x27;GET&#x27;</span>, <span class=\"string\">&#x27;http://127.0.0.1:8000/json-server&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">//发送</span></span><br><span class=\"line\">xhr.send();</span><br><span class=\"line\"><span class=\"comment\">//事件绑定</span></span><br><span class=\"line\">xhr.onreadystatechange = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (xhr.readyState === <span class=\"number\">4</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (xhr.status &gt;= <span class=\"number\">200</span> &amp;&amp; xhr.status &lt; <span class=\"number\">300</span>) &#123;</span><br><span class=\"line\">      <span class=\"comment\">//</span></span><br><span class=\"line\">      <span class=\"comment\">// console.log(xhr.response);</span></span><br><span class=\"line\">      <span class=\"comment\">// result.innerHTML = xhr.response;</span></span><br><span class=\"line\">        </span><br><span class=\"line\">      <span class=\"comment\">// 1. 手动对数据转化</span></span><br><span class=\"line\">      <span class=\"keyword\">let</span> data = <span class=\"built_in\">JSON</span>.parse(xhr.response); <span class=\"comment\">//-----------------------------</span></span><br><span class=\"line\">      <span class=\"built_in\">console</span>.log(data);</span><br><span class=\"line\">      result.innerHTML = data.name; </span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><br></p>\n<h2 id=\"自动转换\"><a href=\"#自动转换\" class=\"headerlink\" title=\"自动转换\"></a>自动转换</h2><p>借助xhr对象上的一个属性来进行设置。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//发送请求</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> xhr = <span class=\"keyword\">new</span> XMLHttpRequest();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//设置响应体数据的类型</span></span><br><span class=\"line\"> xhr.responseType = <span class=\"string\">&#x27;json&#x27;</span>;   <span class=\"comment\">//----------------------------------------</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//初始化</span></span><br><span class=\"line\">xhr.open(<span class=\"string\">&#x27;GET&#x27;</span>, <span class=\"string\">&#x27;http://127.0.0.1:8000/json-server&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">//发送</span></span><br><span class=\"line\">xhr.send();</span><br><span class=\"line\"><span class=\"comment\">//事件绑定</span></span><br><span class=\"line\">xhr.onreadystatechange = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (xhr.readyState === <span class=\"number\">4</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (xhr.status &gt;= <span class=\"number\">200</span> &amp;&amp; xhr.status &lt; <span class=\"number\">300</span>) &#123;</span><br><span class=\"line\">      <span class=\"comment\">//</span></span><br><span class=\"line\">      <span class=\"comment\">// console.log(xhr.response);</span></span><br><span class=\"line\">      <span class=\"comment\">// result.innerHTML = xhr.response;</span></span><br><span class=\"line\">      <span class=\"comment\">// 1. 手动对数据转化</span></span><br><span class=\"line\">      <span class=\"comment\">//let data = JSON.parse(xhr.response);</span></span><br><span class=\"line\">      <span class=\"comment\">//console.log(data);</span></span><br><span class=\"line\">      <span class=\"comment\">//result.innerHTML = data.name;</span></span><br><span class=\"line\">        </span><br><span class=\"line\">      <span class=\"comment\">// // 2. 自动转换</span></span><br><span class=\"line\">       <span class=\"built_in\">console</span>.log(xhr.response);</span><br><span class=\"line\">       result.innerHTML = xhr.response.name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><br><br><br></p>","categories":[{"name":"AJAX","path":"api/categories/AJAX.json"}],"tags":[{"name":"AJAX","path":"api/tags/AJAX.json"}]}