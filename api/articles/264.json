{"title":"JS转换时间戳为刚刚、几分钟前、几小时前、几天前、几周前、几个月前等格式","slug":"264","date":"2023-02-28T06:14:00.000Z","updated":"2023-02-28T06:20:45.492Z","comments":true,"path":"api/articles/264.json","excerpt":null,"covers":null,"content":"<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 思路：获取时间戳的差</span></span><br><span class=\"line\"><span class=\"comment\">// 时间差除以时间格式需要的倍数 如果超过1 则表示时间差在这个等级中</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getDateDiff</span>(<span class=\"params\">dateTimeStamp</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> now = <span class=\"built_in\">Date</span>.now()</span><br><span class=\"line\">  <span class=\"keyword\">const</span> diffValue = now - dateTimeStamp</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (diffValue &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.error(<span class=\"string\">&#x27;结束日期不能小于开始日期！&#x27;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">// 时间格式转换需要的数字倍数</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> minute = <span class=\"number\">1000</span> * <span class=\"number\">60</span> <span class=\"comment\">//</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> hour = minute * <span class=\"number\">60</span><span class=\"comment\">//</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> day = hour * <span class=\"number\">24</span> <span class=\"comment\">// 几天前</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> month = day * <span class=\"number\">30</span> <span class=\"comment\">// 月</span></span><br><span class=\"line\">  <span class=\"comment\">// 时间差 除以时间格式需要的倍数</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> monthC = diffValue / month</span><br><span class=\"line\">  <span class=\"keyword\">const</span> weekC = diffValue / (<span class=\"number\">7</span> * day)</span><br><span class=\"line\">  <span class=\"keyword\">const</span> dayC = diffValue / day</span><br><span class=\"line\">  <span class=\"keyword\">const</span> hourC = diffValue / hour</span><br><span class=\"line\">  <span class=\"keyword\">const</span> minC = diffValue / minute</span><br><span class=\"line\">  <span class=\"comment\">// 如果超过1 则表示时间差在这个等级中</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> result = <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (monthC &gt;= <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    result = <span class=\"string\">`发表于<span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(monthC, <span class=\"number\">10</span>)&#125;</span>个月前`</span></span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (weekC &gt;= <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    result = <span class=\"string\">`发表于<span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(weekC, <span class=\"number\">10</span>)&#125;</span>周前`</span></span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (dayC &gt;= <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    result = <span class=\"string\">`发表于<span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(dayC, <span class=\"number\">10</span>)&#125;</span>天前`</span></span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (hourC &gt;= <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    result = <span class=\"string\">`发表于<span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(hourC, <span class=\"number\">10</span>)&#125;</span>个小时前`</span></span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (minC &gt;= <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    result = <span class=\"string\">`发表于<span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(minC, <span class=\"number\">10</span>)&#125;</span>分钟前`</span></span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> result = <span class=\"string\">&#x27;刚刚发表&#x27;</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> result</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// 测试代码</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(getDateDiff(<span class=\"built_in\">Date</span>.now() - <span class=\"number\">10</span>)) <span class=\"comment\">// 刚刚</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(getDateDiff(<span class=\"built_in\">Date</span>.now() - <span class=\"number\">1000</span> * <span class=\"number\">60</span> * <span class=\"number\">5</span>)) <span class=\"comment\">// 五分钟前</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(getDateDiff(<span class=\"built_in\">Date</span>.now() - <span class=\"number\">1000</span> * <span class=\"number\">60</span> * <span class=\"number\">60</span> * <span class=\"number\">2</span>)) <span class=\"comment\">// 2小时前</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(getDateDiff(<span class=\"built_in\">Date</span>.now() - <span class=\"number\">1000</span> * <span class=\"number\">60</span> * <span class=\"number\">60</span> * <span class=\"number\">24</span> * <span class=\"number\">3</span>)) <span class=\"comment\">// 3天前</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(getDateDiff(<span class=\"built_in\">Date</span>.now() - <span class=\"number\">1000</span> * <span class=\"number\">60</span> * <span class=\"number\">60</span> * <span class=\"number\">24</span> * <span class=\"number\">30</span> * <span class=\"number\">4</span>)) <span class=\"comment\">// 四个月前</span></span><br></pre></td></tr></table></figure>\n\n","more":"<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 思路：获取时间戳的差</span></span><br><span class=\"line\"><span class=\"comment\">// 时间差除以时间格式需要的倍数 如果超过1 则表示时间差在这个等级中</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getDateDiff</span>(<span class=\"params\">dateTimeStamp</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> now = <span class=\"built_in\">Date</span>.now()</span><br><span class=\"line\">  <span class=\"keyword\">const</span> diffValue = now - dateTimeStamp</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (diffValue &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.error(<span class=\"string\">&#x27;结束日期不能小于开始日期！&#x27;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">// 时间格式转换需要的数字倍数</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> minute = <span class=\"number\">1000</span> * <span class=\"number\">60</span> <span class=\"comment\">//</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> hour = minute * <span class=\"number\">60</span><span class=\"comment\">//</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> day = hour * <span class=\"number\">24</span> <span class=\"comment\">// 几天前</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> month = day * <span class=\"number\">30</span> <span class=\"comment\">// 月</span></span><br><span class=\"line\">  <span class=\"comment\">// 时间差 除以时间格式需要的倍数</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> monthC = diffValue / month</span><br><span class=\"line\">  <span class=\"keyword\">const</span> weekC = diffValue / (<span class=\"number\">7</span> * day)</span><br><span class=\"line\">  <span class=\"keyword\">const</span> dayC = diffValue / day</span><br><span class=\"line\">  <span class=\"keyword\">const</span> hourC = diffValue / hour</span><br><span class=\"line\">  <span class=\"keyword\">const</span> minC = diffValue / minute</span><br><span class=\"line\">  <span class=\"comment\">// 如果超过1 则表示时间差在这个等级中</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> result = <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (monthC &gt;= <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    result = <span class=\"string\">`发表于<span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(monthC, <span class=\"number\">10</span>)&#125;</span>个月前`</span></span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (weekC &gt;= <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    result = <span class=\"string\">`发表于<span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(weekC, <span class=\"number\">10</span>)&#125;</span>周前`</span></span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (dayC &gt;= <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    result = <span class=\"string\">`发表于<span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(dayC, <span class=\"number\">10</span>)&#125;</span>天前`</span></span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (hourC &gt;= <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    result = <span class=\"string\">`发表于<span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(hourC, <span class=\"number\">10</span>)&#125;</span>个小时前`</span></span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (minC &gt;= <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    result = <span class=\"string\">`发表于<span class=\"subst\">$&#123;<span class=\"built_in\">parseInt</span>(minC, <span class=\"number\">10</span>)&#125;</span>分钟前`</span></span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> result = <span class=\"string\">&#x27;刚刚发表&#x27;</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> result</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// 测试代码</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(getDateDiff(<span class=\"built_in\">Date</span>.now() - <span class=\"number\">10</span>)) <span class=\"comment\">// 刚刚</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(getDateDiff(<span class=\"built_in\">Date</span>.now() - <span class=\"number\">1000</span> * <span class=\"number\">60</span> * <span class=\"number\">5</span>)) <span class=\"comment\">// 五分钟前</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(getDateDiff(<span class=\"built_in\">Date</span>.now() - <span class=\"number\">1000</span> * <span class=\"number\">60</span> * <span class=\"number\">60</span> * <span class=\"number\">2</span>)) <span class=\"comment\">// 2小时前</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(getDateDiff(<span class=\"built_in\">Date</span>.now() - <span class=\"number\">1000</span> * <span class=\"number\">60</span> * <span class=\"number\">60</span> * <span class=\"number\">24</span> * <span class=\"number\">3</span>)) <span class=\"comment\">// 3天前</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(getDateDiff(<span class=\"built_in\">Date</span>.now() - <span class=\"number\">1000</span> * <span class=\"number\">60</span> * <span class=\"number\">60</span> * <span class=\"number\">24</span> * <span class=\"number\">30</span> * <span class=\"number\">4</span>)) <span class=\"comment\">// 四个月前</span></span><br></pre></td></tr></table></figure>\n\n","categories":[{"name":"JavaScript","path":"api/categories/JavaScript.json"}],"tags":[{"name":"JavaScript","path":"api/tags/JavaScript.json"},{"name":"时间戳","path":"api/tags/时间戳.json"}]}