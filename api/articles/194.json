{"title":"uniapp开发中 scroll-view 自定义下拉刷新实现","slug":"194","date":"2022-07-21T08:46:34.561Z","updated":"2022-07-21T08:46:34.561Z","comments":true,"path":"api/articles/194.json","excerpt":null,"covers":null,"content":"<p>官方文档： <a class=\"btn-beautify block larger\" href=\"https://uniapp.dcloud.io/component/scroll-view\" \n  title=\"点击前往\"><i class=\"far fa-hand-point-right\"></i><span>点击前往</span></a></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">scroll-view</span> <span class=\"attr\">scroll-y</span> </span></span><br><span class=\"line\"><span class=\"tag\">\t<span class=\"attr\">:refresher-threshold</span>=<span class=\"string\">&quot;45&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">\t<span class=\"attr\">:refresher-enabled</span>=<span class=\"string\">&quot;true&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">\t<span class=\"attr\">:refresher-triggered</span>=<span class=\"string\">&quot;refresherTriggered&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">\t@<span class=\"attr\">refresherrefresh</span>=<span class=\"string\">&quot;refresherrefresh&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">\t@<span class=\"attr\">refresherrestore</span>=<span class=\"string\">&quot;refresherrestore&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">\t@<span class=\"attr\">refresherabort</span>=<span class=\"string\">&quot;refresherabort&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">\t&lt;<span class=\"attr\">view</span>&gt;</span>内容内容内容内容内容内容内容内容内容<span class=\"tag\">&lt;/<span class=\"name\">view</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">scroll-view</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"title\">data</span>(<span class=\"params\"></span>)</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"attr\">refresherTriggered</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">\t\t<span class=\"attr\">_refresherTriggered</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">methods: &#123;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"title\">refresherrefresh</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;自定义下拉刷新被触发&quot;</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> _this = <span class=\"built_in\">this</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (_this._refresherTriggered) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t_this._refresherTriggered = <span class=\"literal\">true</span>;</span><br><span class=\"line\">\t\t<span class=\"comment\">//界面下拉触发，triggered可能不是true，要设为true</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (!_this.refresherTriggered) &#123;</span><br><span class=\"line\">\t\t\t_this.refresherTriggered = <span class=\"literal\">true</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"built_in\">this</span>.loadStoreData();</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"title\">refresherrestore</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;自定义下拉刷新被复位&quot;</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> _this = <span class=\"built_in\">this</span>;</span><br><span class=\"line\">\t\t_this.refresherTriggered = <span class=\"literal\">false</span>;</span><br><span class=\"line\">\t\t_this._refresherTriggered = <span class=\"literal\">false</span>;</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"title\">refresherabort</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;自定义下拉刷新被中止\t&quot;</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> _this = <span class=\"built_in\">this</span>;</span><br><span class=\"line\">\t\t_this.refresherTriggered = <span class=\"literal\">false</span>;</span><br><span class=\"line\">\t\t_this._refresherTriggered = <span class=\"literal\">false</span>;</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"title\">loadStoreData</span>(<span class=\"params\"></span>)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> _this = <span class=\"built_in\">this</span>;</span><br><span class=\"line\">\t\t<span class=\"built_in\">this</span>.listData();</span><br><span class=\"line\">\t\t<span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">\t\t\t_this.refresherTriggered = <span class=\"literal\">false</span>;<span class=\"comment\">//触发onRestore，并关闭刷新图标</span></span><br><span class=\"line\">\t\t\t_this._refresherTriggered = <span class=\"literal\">false</span>;</span><br><span class=\"line\">\t\t&#125;, <span class=\"number\">1000</span>)</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"title\">listData</span>(<span class=\"params\"></span>)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> _this = <span class=\"built_in\">this</span>;</span><br><span class=\"line\">\t\t<span class=\"comment\">//这里是调用后台接口的方法数据</span></span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>注意：_refresherTriggered 的作用是用于缓存状态，防止loadStoreData这个异步操作没有完成的时候再次刷新</p>\n","more":"<p>官方文档： <a class=\"btn-beautify block larger\" href=\"https://uniapp.dcloud.io/component/scroll-view\" \n  title=\"点击前往\"><i class=\"far fa-hand-point-right\"></i><span>点击前往</span></a></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">scroll-view</span> <span class=\"attr\">scroll-y</span> </span></span><br><span class=\"line\"><span class=\"tag\">\t<span class=\"attr\">:refresher-threshold</span>=<span class=\"string\">&quot;45&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">\t<span class=\"attr\">:refresher-enabled</span>=<span class=\"string\">&quot;true&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">\t<span class=\"attr\">:refresher-triggered</span>=<span class=\"string\">&quot;refresherTriggered&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">\t@<span class=\"attr\">refresherrefresh</span>=<span class=\"string\">&quot;refresherrefresh&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">\t@<span class=\"attr\">refresherrestore</span>=<span class=\"string\">&quot;refresherrestore&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">\t@<span class=\"attr\">refresherabort</span>=<span class=\"string\">&quot;refresherabort&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">\t&lt;<span class=\"attr\">view</span>&gt;</span>内容内容内容内容内容内容内容内容内容<span class=\"tag\">&lt;/<span class=\"name\">view</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">scroll-view</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"title\">data</span>(<span class=\"params\"></span>)</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"attr\">refresherTriggered</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">\t\t<span class=\"attr\">_refresherTriggered</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">methods: &#123;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"title\">refresherrefresh</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;自定义下拉刷新被触发&quot;</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> _this = <span class=\"built_in\">this</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (_this._refresherTriggered) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t_this._refresherTriggered = <span class=\"literal\">true</span>;</span><br><span class=\"line\">\t\t<span class=\"comment\">//界面下拉触发，triggered可能不是true，要设为true</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (!_this.refresherTriggered) &#123;</span><br><span class=\"line\">\t\t\t_this.refresherTriggered = <span class=\"literal\">true</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"built_in\">this</span>.loadStoreData();</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"title\">refresherrestore</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;自定义下拉刷新被复位&quot;</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> _this = <span class=\"built_in\">this</span>;</span><br><span class=\"line\">\t\t_this.refresherTriggered = <span class=\"literal\">false</span>;</span><br><span class=\"line\">\t\t_this._refresherTriggered = <span class=\"literal\">false</span>;</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"title\">refresherabort</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">console</span>.log(<span class=\"string\">&quot;自定义下拉刷新被中止\t&quot;</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> _this = <span class=\"built_in\">this</span>;</span><br><span class=\"line\">\t\t_this.refresherTriggered = <span class=\"literal\">false</span>;</span><br><span class=\"line\">\t\t_this._refresherTriggered = <span class=\"literal\">false</span>;</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"title\">loadStoreData</span>(<span class=\"params\"></span>)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> _this = <span class=\"built_in\">this</span>;</span><br><span class=\"line\">\t\t<span class=\"built_in\">this</span>.listData();</span><br><span class=\"line\">\t\t<span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">\t\t\t_this.refresherTriggered = <span class=\"literal\">false</span>;<span class=\"comment\">//触发onRestore，并关闭刷新图标</span></span><br><span class=\"line\">\t\t\t_this._refresherTriggered = <span class=\"literal\">false</span>;</span><br><span class=\"line\">\t\t&#125;, <span class=\"number\">1000</span>)</span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"title\">listData</span>(<span class=\"params\"></span>)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> _this = <span class=\"built_in\">this</span>;</span><br><span class=\"line\">\t\t<span class=\"comment\">//这里是调用后台接口的方法数据</span></span><br><span class=\"line\">\t&#125;,</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>注意：_refresherTriggered 的作用是用于缓存状态，防止loadStoreData这个异步操作没有完成的时候再次刷新</p>\n","categories":[{"name":"uni-app开发","path":"api/categories/uni-app开发.json"}],"tags":[{"name":"微信小程序","path":"api/tags/微信小程序.json"},{"name":"uni-app开发","path":"api/tags/uni-app开发.json"}]}