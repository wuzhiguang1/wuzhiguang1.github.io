{"title":"JavaScript 元素的拖放事件","slug":"31","date":"2020-06-01T12:53:17.000Z","updated":"2022-07-29T04:22:04.783Z","comments":true,"path":"api/articles/31.json","excerpt":" [Figure] ","covers":["https://qny.aqingya.cn/img/30d4b93392a94ca5aa1f11cf9b6b8bfb.jpg"],"content":"<p><img src=\"https://qny.aqingya.cn/img/30d4b93392a94ca5aa1f11cf9b6b8bfb.jpg\"></p>\n<span id=\"more\"></span>\n\n\n\n<p>为了让元素可拖动，需要使用 HTML5 <a href=\"https://www.runoob.com/tags/att-global-draggable.html\">draggable</a> 属性。<br>链接和图片默认是可拖动的，不需要 draggable 属性</p>\n<br>\n\n<p>在拖放的过程中会触发以下事件：</p>\n<ol>\n<li>在拖动目标上触发事件 (源元素):</li>\n</ol>\n<blockquote>\n<ul>\n<li><a href=\"https://www.runoob.com/jsref/event-ondragstart.html\">ondragstart</a> - 用户开始拖动元素时触发</li>\n<li><a href=\"https://www.runoob.com/jsref/event-ondrag.html\">ondrag</a> - 元素正在拖动时触发</li>\n<li><a href=\"https://www.runoob.com/jsref/event-ondragend.html\">ondragend</a> - 用户完成元素拖动后触发</li>\n</ul>\n</blockquote>\n<ol start=\"2\">\n<li>释放目标时触发的事件:</li>\n</ol>\n<blockquote>\n<ul>\n<li><a href=\"https://www.runoob.com/jsref/event-ondragenter.html\">ondragenter</a> - 当被鼠标拖动的对象进入其容器范围内时触发此事件</li>\n<li><a href=\"https://www.runoob.com/jsref/event-ondragover.html\">ondragover</a> - 当某被拖动的对象在另一对象容器范围内拖动时触发此事件</li>\n<li><a href=\"https://www.runoob.com/jsref/event-ondragleave.html\">ondragleave</a> - 当被鼠标拖动的对象离开其容器范围内时触发此事件</li>\n<li><a href=\"https://www.runoob.com/jsref/event-ondrop.html\">ondrop</a> - 在一个拖动过程中，释放鼠标键时触发此事件</li>\n</ul>\n</blockquote>\n<br>\n\n<p>将span拖放到div中</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!DOCTYPE html&gt;</span><br><span class=\"line\">&lt;html lang=&quot;en&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;head&gt;</span><br><span class=\"line\">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class=\"line\">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class=\"line\">    &lt;title&gt;Document&lt;/title&gt;</span><br><span class=\"line\">    &lt;script&gt;</span><br><span class=\"line\">        window.onload = function() &#123;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">            EventUtil.addHandler(document, &quot;dragstart&quot;, function(event) &#123;</span><br><span class=\"line\">                event = EventUtil.getEvent(event);</span><br><span class=\"line\">                //dataTransfer.setData()方法设置数据类型和拖动的数据</span><br><span class=\"line\">                event.dataTransfer.setData(&quot;Text&quot;, event.target.id);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">            / 默认情况下,数据/元素不能在其他元素中被拖放。</span><br><span class=\"line\">            对于drop我们必须防止元素的默认处理</span><br><span class=\"line\">            EventUtil.addHandler(document, &quot;dragover&quot;, function(event) &#123;</span><br><span class=\"line\">                event = EventUtil.getEvent(event);</span><br><span class=\"line\">                EventUtil.preventDefault(event);</span><br><span class=\"line\"></span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">            /*对于drop,防止浏览器的默认处理数据(在drop中链接是默认打开)</span><br><span class=\"line\">        </span><br><span class=\"line\">            利用dataTransfer.getData()方法获得拖放数据</span><br><span class=\"line\">            拖拖的数据元素id</span><br><span class=\"line\">            拖拽元素附加到drop元素*/</span><br><span class=\"line\">            EventUtil.addHandler(document, &quot;drop&quot;, function(event) &#123;</span><br><span class=\"line\">                event = EventUtil.getEvent(event);</span><br><span class=\"line\">                EventUtil.preventDefault(event);</span><br><span class=\"line\">                target = EventUtil.getTarget(event);</span><br><span class=\"line\">                if (event.target.className == &quot;droptarget&quot;) &#123;</span><br><span class=\"line\">                    var data = event.dataTransfer.getData(&quot;Text&quot;);</span><br><span class=\"line\">                    event.target.appendChild(document.getElementById(data));</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                // alert(&quot;ss&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        var EventUtil = &#123;</span><br><span class=\"line\">            addHandler: function(element, type, handler) &#123;</span><br><span class=\"line\">                if (element.addEventListener) &#123;</span><br><span class=\"line\">                    element.addEventListener(type, handler, false);</span><br><span class=\"line\">                &#125; else if (element.attachEvent) &#123;</span><br><span class=\"line\">                    element.attachEvent(&quot;on&quot; + type, handler);</span><br><span class=\"line\">                &#125; else &#123;</span><br><span class=\"line\">                    element[&quot;on&quot; + type] = handler;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">            // 解决浏览器兼容性问题</span><br><span class=\"line\">            getEvent: function(event) &#123;</span><br><span class=\"line\">                return event ? event : window.event;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">            // 返回事件目标</span><br><span class=\"line\">            getTarget: function(event) &#123;</span><br><span class=\"line\">                return event.target || event.srcElement;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">            //取消事件的默认行为。</span><br><span class=\"line\">            preventDefault: function(event) &#123;</span><br><span class=\"line\">                if (event.preventDefault) &#123;</span><br><span class=\"line\">                    event.preventDefault();</span><br><span class=\"line\">                &#125; else &#123;</span><br><span class=\"line\">                    event.returnValue = false;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">            // 移除事件处理程序</span><br><span class=\"line\">            removeHandler: function(element, type, handler) &#123;</span><br><span class=\"line\">                if (element.removeEventListener) &#123;</span><br><span class=\"line\">                    element.removeEventListener(type, handler, false);</span><br><span class=\"line\">                &#125; else if (element.detachEvent) &#123;</span><br><span class=\"line\">                    element.detachEvent(&quot;on&quot; + type, handler);</span><br><span class=\"line\">                &#125; else &#123;</span><br><span class=\"line\">                    element[&quot;on&quot; + type] = null;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">            //提供相关元素的信息，relatedTarget这个属性只对与mouseover和mouseout事件才包含值。</span><br><span class=\"line\">            getRelatedTarget: function(event) &#123;</span><br><span class=\"line\">                if (event.relatedTarget) &#123;</span><br><span class=\"line\">                    return event.relatedTarget;</span><br><span class=\"line\">                &#125; else if (event.toElement) &#123;</span><br><span class=\"line\">                    return event.toElement;</span><br><span class=\"line\">                &#125; else if (event.fromElement) &#123;</span><br><span class=\"line\">                    return event.fromElement;</span><br><span class=\"line\">                &#125; else &#123;</span><br><span class=\"line\">                    return null;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">            //获取鼠标按钮</span><br><span class=\"line\">            /**</span><br><span class=\"line\">             *  0: 表示没有按下按钮。</span><br><span class=\"line\">                1: 表示按下了主鼠标按钮。</span><br><span class=\"line\">                2: 表示按下了次鼠标按钮。</span><br><span class=\"line\">                3: 表示同时按下了主、次鼠标按钮</span><br><span class=\"line\">                4: 表示按下了中间的鼠标按钮。</span><br><span class=\"line\">                5: 表示同时按下了主鼠标按钮和中间的鼠标按钮。</span><br><span class=\"line\">                6: 表示同时按下了次鼠标按钮和中间的鼠标按钮。</span><br><span class=\"line\">                7: 表示同时按下了三个鼠标按钮。*/</span><br><span class=\"line\">            getButton: function(event) &#123;</span><br><span class=\"line\">                if (document.implementation.hasFeature(&quot;MouseEvents&quot;, &quot;2.0&quot;)) &#123;</span><br><span class=\"line\">                    return event.button;</span><br><span class=\"line\">                &#125; else &#123;</span><br><span class=\"line\">                    switch (event.button) &#123;</span><br><span class=\"line\">                        case 0:</span><br><span class=\"line\">                        case 1:</span><br><span class=\"line\">                        case 3:</span><br><span class=\"line\">                        case 5:</span><br><span class=\"line\">                        case 7:</span><br><span class=\"line\">                            return 0;</span><br><span class=\"line\">                        case 2:</span><br><span class=\"line\">                        case 6:</span><br><span class=\"line\">                            return 2;</span><br><span class=\"line\">                        case 4:</span><br><span class=\"line\">                            return 1;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">            //获得鼠标滚轮的增量值delta</span><br><span class=\"line\">            getWheelDelta: function(event) &#123;</span><br><span class=\"line\">                if (event.wheelDelta) &#123;</span><br><span class=\"line\">                    return (client.engine.opera &amp;&amp; client.engine.opera &lt; 9.5 ?</span><br><span class=\"line\">                        -event.wheelDelta : event.wheelDelta);</span><br><span class=\"line\">                &#125; else &#123;</span><br><span class=\"line\">                    return -event.detail * 40;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">            //获取字符串编码  主要用于文本框 监听事件是keypress</span><br><span class=\"line\">            getCharCode: function(event) &#123;</span><br><span class=\"line\">                if (typeof event.charCode == &quot;number&quot;) &#123;</span><br><span class=\"line\">                    return event.charCode;</span><br><span class=\"line\">                &#125; else &#123;</span><br><span class=\"line\">                    return event.keyCode;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">            //取消进一步的事件捕获或者冒泡</span><br><span class=\"line\">            stopPropagation: function(event) &#123;</span><br><span class=\"line\">                if (event.stopPropagation) &#123;</span><br><span class=\"line\">                    event.stopPropagation();</span><br><span class=\"line\">                &#125; else &#123;</span><br><span class=\"line\">                    event.cancelBubble = true;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">    &lt;/script&gt;</span><br><span class=\"line\">    &lt;style&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;/style&gt;</span><br><span class=\"line\">&lt;/head&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;body&gt;</span><br><span class=\"line\">    &lt;a href=&quot;https://www.baidu.com&quot; id=&quot;dragtarget&quot;&gt;百度一下&lt;/a&gt;</span><br><span class=\"line\">    &lt;br&gt;</span><br><span class=\"line\">    &lt;br&gt;</span><br><span class=\"line\">    &lt;span draggable=&quot;true&quot; id=&quot;dragtarget1&quot;&gt;阿清呀&lt;/span&gt;</span><br><span class=\"line\">    &lt;br&gt;</span><br><span class=\"line\">    &lt;br&gt;</span><br><span class=\"line\">    &lt;div style=&quot;width:100px;height:100px;background-color: #bfa;&quot; class=&quot;droptarget&quot;&gt;&lt;/div&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;/body&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;/html&gt;</span><br></pre></td></tr></table></figure>\n\n<hr>\n<br>\n<br>\n愿你的坚持终有收获。\n<br>\n<br>\n\n\n\n\n","more":"<p>为了让元素可拖动，需要使用 HTML5 <a href=\"https://www.runoob.com/tags/att-global-draggable.html\">draggable</a> 属性。<br>链接和图片默认是可拖动的，不需要 draggable 属性</p>\n<br>\n\n<p>在拖放的过程中会触发以下事件：</p>\n<ol>\n<li>在拖动目标上触发事件 (源元素):</li>\n</ol>\n<blockquote>\n<ul>\n<li><a href=\"https://www.runoob.com/jsref/event-ondragstart.html\">ondragstart</a> - 用户开始拖动元素时触发</li>\n<li><a href=\"https://www.runoob.com/jsref/event-ondrag.html\">ondrag</a> - 元素正在拖动时触发</li>\n<li><a href=\"https://www.runoob.com/jsref/event-ondragend.html\">ondragend</a> - 用户完成元素拖动后触发</li>\n</ul>\n</blockquote>\n<ol start=\"2\">\n<li>释放目标时触发的事件:</li>\n</ol>\n<blockquote>\n<ul>\n<li><a href=\"https://www.runoob.com/jsref/event-ondragenter.html\">ondragenter</a> - 当被鼠标拖动的对象进入其容器范围内时触发此事件</li>\n<li><a href=\"https://www.runoob.com/jsref/event-ondragover.html\">ondragover</a> - 当某被拖动的对象在另一对象容器范围内拖动时触发此事件</li>\n<li><a href=\"https://www.runoob.com/jsref/event-ondragleave.html\">ondragleave</a> - 当被鼠标拖动的对象离开其容器范围内时触发此事件</li>\n<li><a href=\"https://www.runoob.com/jsref/event-ondrop.html\">ondrop</a> - 在一个拖动过程中，释放鼠标键时触发此事件</li>\n</ul>\n</blockquote>\n<br>\n\n<p>将span拖放到div中</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!DOCTYPE html&gt;</span><br><span class=\"line\">&lt;html lang=&quot;en&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;head&gt;</span><br><span class=\"line\">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class=\"line\">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class=\"line\">    &lt;title&gt;Document&lt;/title&gt;</span><br><span class=\"line\">    &lt;script&gt;</span><br><span class=\"line\">        window.onload = function() &#123;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">            EventUtil.addHandler(document, &quot;dragstart&quot;, function(event) &#123;</span><br><span class=\"line\">                event = EventUtil.getEvent(event);</span><br><span class=\"line\">                //dataTransfer.setData()方法设置数据类型和拖动的数据</span><br><span class=\"line\">                event.dataTransfer.setData(&quot;Text&quot;, event.target.id);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">            / 默认情况下,数据/元素不能在其他元素中被拖放。</span><br><span class=\"line\">            对于drop我们必须防止元素的默认处理</span><br><span class=\"line\">            EventUtil.addHandler(document, &quot;dragover&quot;, function(event) &#123;</span><br><span class=\"line\">                event = EventUtil.getEvent(event);</span><br><span class=\"line\">                EventUtil.preventDefault(event);</span><br><span class=\"line\"></span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">            /*对于drop,防止浏览器的默认处理数据(在drop中链接是默认打开)</span><br><span class=\"line\">        </span><br><span class=\"line\">            利用dataTransfer.getData()方法获得拖放数据</span><br><span class=\"line\">            拖拖的数据元素id</span><br><span class=\"line\">            拖拽元素附加到drop元素*/</span><br><span class=\"line\">            EventUtil.addHandler(document, &quot;drop&quot;, function(event) &#123;</span><br><span class=\"line\">                event = EventUtil.getEvent(event);</span><br><span class=\"line\">                EventUtil.preventDefault(event);</span><br><span class=\"line\">                target = EventUtil.getTarget(event);</span><br><span class=\"line\">                if (event.target.className == &quot;droptarget&quot;) &#123;</span><br><span class=\"line\">                    var data = event.dataTransfer.getData(&quot;Text&quot;);</span><br><span class=\"line\">                    event.target.appendChild(document.getElementById(data));</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                // alert(&quot;ss&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        var EventUtil = &#123;</span><br><span class=\"line\">            addHandler: function(element, type, handler) &#123;</span><br><span class=\"line\">                if (element.addEventListener) &#123;</span><br><span class=\"line\">                    element.addEventListener(type, handler, false);</span><br><span class=\"line\">                &#125; else if (element.attachEvent) &#123;</span><br><span class=\"line\">                    element.attachEvent(&quot;on&quot; + type, handler);</span><br><span class=\"line\">                &#125; else &#123;</span><br><span class=\"line\">                    element[&quot;on&quot; + type] = handler;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">            // 解决浏览器兼容性问题</span><br><span class=\"line\">            getEvent: function(event) &#123;</span><br><span class=\"line\">                return event ? event : window.event;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">            // 返回事件目标</span><br><span class=\"line\">            getTarget: function(event) &#123;</span><br><span class=\"line\">                return event.target || event.srcElement;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">            //取消事件的默认行为。</span><br><span class=\"line\">            preventDefault: function(event) &#123;</span><br><span class=\"line\">                if (event.preventDefault) &#123;</span><br><span class=\"line\">                    event.preventDefault();</span><br><span class=\"line\">                &#125; else &#123;</span><br><span class=\"line\">                    event.returnValue = false;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">            // 移除事件处理程序</span><br><span class=\"line\">            removeHandler: function(element, type, handler) &#123;</span><br><span class=\"line\">                if (element.removeEventListener) &#123;</span><br><span class=\"line\">                    element.removeEventListener(type, handler, false);</span><br><span class=\"line\">                &#125; else if (element.detachEvent) &#123;</span><br><span class=\"line\">                    element.detachEvent(&quot;on&quot; + type, handler);</span><br><span class=\"line\">                &#125; else &#123;</span><br><span class=\"line\">                    element[&quot;on&quot; + type] = null;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">            //提供相关元素的信息，relatedTarget这个属性只对与mouseover和mouseout事件才包含值。</span><br><span class=\"line\">            getRelatedTarget: function(event) &#123;</span><br><span class=\"line\">                if (event.relatedTarget) &#123;</span><br><span class=\"line\">                    return event.relatedTarget;</span><br><span class=\"line\">                &#125; else if (event.toElement) &#123;</span><br><span class=\"line\">                    return event.toElement;</span><br><span class=\"line\">                &#125; else if (event.fromElement) &#123;</span><br><span class=\"line\">                    return event.fromElement;</span><br><span class=\"line\">                &#125; else &#123;</span><br><span class=\"line\">                    return null;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">            //获取鼠标按钮</span><br><span class=\"line\">            /**</span><br><span class=\"line\">             *  0: 表示没有按下按钮。</span><br><span class=\"line\">                1: 表示按下了主鼠标按钮。</span><br><span class=\"line\">                2: 表示按下了次鼠标按钮。</span><br><span class=\"line\">                3: 表示同时按下了主、次鼠标按钮</span><br><span class=\"line\">                4: 表示按下了中间的鼠标按钮。</span><br><span class=\"line\">                5: 表示同时按下了主鼠标按钮和中间的鼠标按钮。</span><br><span class=\"line\">                6: 表示同时按下了次鼠标按钮和中间的鼠标按钮。</span><br><span class=\"line\">                7: 表示同时按下了三个鼠标按钮。*/</span><br><span class=\"line\">            getButton: function(event) &#123;</span><br><span class=\"line\">                if (document.implementation.hasFeature(&quot;MouseEvents&quot;, &quot;2.0&quot;)) &#123;</span><br><span class=\"line\">                    return event.button;</span><br><span class=\"line\">                &#125; else &#123;</span><br><span class=\"line\">                    switch (event.button) &#123;</span><br><span class=\"line\">                        case 0:</span><br><span class=\"line\">                        case 1:</span><br><span class=\"line\">                        case 3:</span><br><span class=\"line\">                        case 5:</span><br><span class=\"line\">                        case 7:</span><br><span class=\"line\">                            return 0;</span><br><span class=\"line\">                        case 2:</span><br><span class=\"line\">                        case 6:</span><br><span class=\"line\">                            return 2;</span><br><span class=\"line\">                        case 4:</span><br><span class=\"line\">                            return 1;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">            //获得鼠标滚轮的增量值delta</span><br><span class=\"line\">            getWheelDelta: function(event) &#123;</span><br><span class=\"line\">                if (event.wheelDelta) &#123;</span><br><span class=\"line\">                    return (client.engine.opera &amp;&amp; client.engine.opera &lt; 9.5 ?</span><br><span class=\"line\">                        -event.wheelDelta : event.wheelDelta);</span><br><span class=\"line\">                &#125; else &#123;</span><br><span class=\"line\">                    return -event.detail * 40;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">            //获取字符串编码  主要用于文本框 监听事件是keypress</span><br><span class=\"line\">            getCharCode: function(event) &#123;</span><br><span class=\"line\">                if (typeof event.charCode == &quot;number&quot;) &#123;</span><br><span class=\"line\">                    return event.charCode;</span><br><span class=\"line\">                &#125; else &#123;</span><br><span class=\"line\">                    return event.keyCode;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">            //取消进一步的事件捕获或者冒泡</span><br><span class=\"line\">            stopPropagation: function(event) &#123;</span><br><span class=\"line\">                if (event.stopPropagation) &#123;</span><br><span class=\"line\">                    event.stopPropagation();</span><br><span class=\"line\">                &#125; else &#123;</span><br><span class=\"line\">                    event.cancelBubble = true;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">    &lt;/script&gt;</span><br><span class=\"line\">    &lt;style&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;/style&gt;</span><br><span class=\"line\">&lt;/head&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;body&gt;</span><br><span class=\"line\">    &lt;a href=&quot;https://www.baidu.com&quot; id=&quot;dragtarget&quot;&gt;百度一下&lt;/a&gt;</span><br><span class=\"line\">    &lt;br&gt;</span><br><span class=\"line\">    &lt;br&gt;</span><br><span class=\"line\">    &lt;span draggable=&quot;true&quot; id=&quot;dragtarget1&quot;&gt;阿清呀&lt;/span&gt;</span><br><span class=\"line\">    &lt;br&gt;</span><br><span class=\"line\">    &lt;br&gt;</span><br><span class=\"line\">    &lt;div style=&quot;width:100px;height:100px;background-color: #bfa;&quot; class=&quot;droptarget&quot;&gt;&lt;/div&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;/body&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;/html&gt;</span><br></pre></td></tr></table></figure>\n\n<hr>\n<br>\n<br>\n愿你的坚持终有收获。\n<br>\n<br>","categories":[{"name":"JavaScript","path":"api/categories/JavaScript.json"}],"tags":[{"name":"JavaScript","path":"api/tags/JavaScript.json"}]}