{"title":"打包微信小程序时，所欲分包页面的 js，会被打包到主包的 vendor.js 中导致文件过大问题总结","slug":"175","date":"2021-11-27T03:28:27.000Z","updated":"2021-11-27T03:51:15.000Z","comments":true,"path":"api/articles/175.json","excerpt":null,"covers":null,"content":"<h2 id=\"详细问题描述\"><a href=\"#详细问题描述\" class=\"headerlink\" title=\"详细问题描述\"></a>详细问题描述</h2><p>uniapp 在进行微信小程序打包时，会将分包页面引入的 js 打包到主包的 vendor.js 中。<br>页面较多时，主包文件大小会超过 2M 的限制。<br>vendor.js 文件会超过 500k 也会影响 ES6 转 ES5 等问题。</p>\n<h2 id=\"解决方式\"><a href=\"#解决方式\" class=\"headerlink\" title=\"解决方式\"></a>解决方式</h2><p>可以采用压缩和拆分，可以单独采用或者同时进行<br>压缩：pacakge.json中添加参数—minimize</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">&quot;dev:mp-weixin&quot;</span>: <span class=\"string\">&quot;cross-env NODE_ENV=development ZHICHI_ENV=develop UNI_PLATFORM=mp-weixin vue-cli-service uni-build --watch --minimize&quot;</span></span><br></pre></td></tr></table></figure>\n<p>拆分：manifest.json中增加参数subPackages</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">&quot;mp-weixin&quot;</span>: &#123;  </span><br><span class=\"line\">        <span class=\"string\">&quot;appid&quot;</span>: <span class=\"string\">&quot;&quot;</span>,  </span><br><span class=\"line\">        <span class=\"string\">&quot;permission&quot;</span>: &#123;  </span><br><span class=\"line\">            <span class=\"string\">&quot;scope.userLocation&quot;</span>: &#123;  </span><br><span class=\"line\">                <span class=\"string\">&quot;desc&quot;</span>: <span class=\"string\">&quot;你的位置信息将用于地理位置展示与距离计算&quot;</span>  </span><br><span class=\"line\">            &#125;  </span><br><span class=\"line\">        &#125;,  </span><br><span class=\"line\">        <span class=\"string\">&quot;setting&quot;</span>: &#123;  </span><br><span class=\"line\">            <span class=\"string\">&quot;urlCheck&quot;</span>: <span class=\"literal\">false</span>  </span><br><span class=\"line\">        &#125;,  </span><br><span class=\"line\">        <span class=\"string\">&quot;usingComponents&quot;</span>: <span class=\"literal\">true</span>,  </span><br><span class=\"line\">        <span class=\"string\">&quot;optimization&quot;</span>: &#123;  </span><br><span class=\"line\">            <span class=\"string\">&quot;subPackages&quot;</span>: <span class=\"literal\">true</span>  </span><br><span class=\"line\">        &#125;  </span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n","more":"<h2 id=\"详细问题描述\"><a href=\"#详细问题描述\" class=\"headerlink\" title=\"详细问题描述\"></a>详细问题描述</h2><p>uniapp 在进行微信小程序打包时，会将分包页面引入的 js 打包到主包的 vendor.js 中。<br>页面较多时，主包文件大小会超过 2M 的限制。<br>vendor.js 文件会超过 500k 也会影响 ES6 转 ES5 等问题。</p>\n<h2 id=\"解决方式\"><a href=\"#解决方式\" class=\"headerlink\" title=\"解决方式\"></a>解决方式</h2><p>可以采用压缩和拆分，可以单独采用或者同时进行<br>压缩：pacakge.json中添加参数—minimize</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">&quot;dev:mp-weixin&quot;</span>: <span class=\"string\">&quot;cross-env NODE_ENV=development ZHICHI_ENV=develop UNI_PLATFORM=mp-weixin vue-cli-service uni-build --watch --minimize&quot;</span></span><br></pre></td></tr></table></figure>\n<p>拆分：manifest.json中增加参数subPackages</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">&quot;mp-weixin&quot;</span>: &#123;  </span><br><span class=\"line\">        <span class=\"string\">&quot;appid&quot;</span>: <span class=\"string\">&quot;&quot;</span>,  </span><br><span class=\"line\">        <span class=\"string\">&quot;permission&quot;</span>: &#123;  </span><br><span class=\"line\">            <span class=\"string\">&quot;scope.userLocation&quot;</span>: &#123;  </span><br><span class=\"line\">                <span class=\"string\">&quot;desc&quot;</span>: <span class=\"string\">&quot;你的位置信息将用于地理位置展示与距离计算&quot;</span>  </span><br><span class=\"line\">            &#125;  </span><br><span class=\"line\">        &#125;,  </span><br><span class=\"line\">        <span class=\"string\">&quot;setting&quot;</span>: &#123;  </span><br><span class=\"line\">            <span class=\"string\">&quot;urlCheck&quot;</span>: <span class=\"literal\">false</span>  </span><br><span class=\"line\">        &#125;,  </span><br><span class=\"line\">        <span class=\"string\">&quot;usingComponents&quot;</span>: <span class=\"literal\">true</span>,  </span><br><span class=\"line\">        <span class=\"string\">&quot;optimization&quot;</span>: &#123;  </span><br><span class=\"line\">            <span class=\"string\">&quot;subPackages&quot;</span>: <span class=\"literal\">true</span>  </span><br><span class=\"line\">        &#125;  </span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n","categories":[{"name":"uni-app开发","path":"api/categories/uni-app开发.json"}],"tags":[{"name":"微信小程序","path":"api/tags/微信小程序.json"},{"name":"uni-app开发","path":"api/tags/uni-app开发.json"}]}